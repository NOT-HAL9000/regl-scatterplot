import{S as t,L as e,B as i,a as n}from"./vendor.70696f60.js";
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */function r(t,e,i,n){return new(i||(i=Promise))((function(r,s){function o(t){try{c(n.next(t))}catch(e){s(e)}}function a(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?r(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(o,a)}c((n=n.apply(t,e||[])).next())}))}function s(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],n=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t){return this instanceof o?(this.v=t,this):new o(t)}function a(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,r=i.apply(t,e||[]),s=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(t){r[t]&&(n[t]=function(e){return new Promise((function(i,n){s.push([t,e,i,n])>1||c(t,e)}))})}function c(t,e){try{(i=r[t](e)).value instanceof o?Promise.resolve(i.value.v).then(l,u):d(s[0][2],i)}catch(n){d(s[0][3],n)}var i}function l(t){c("next",t)}function u(t){c("throw",t)}function d(t,e){t(e),s.shift(),s.length&&c(s[0][0],s[0][1])}}function c(t){var e,i;return e={},n("next"),n("throw",(function(t){throw t})),n("return"),e[Symbol.iterator]=function(){return this},e;function n(n,r){e[n]=t[n]?function(e){return(i=!i)?{value:o(t[n](e)),done:"return"===n}:r?r(e):e}:r}}function l(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,i=t[Symbol.asyncIterator];return i?i.call(t):(t=s(t),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(i){e[i]=t[i]&&function(e){return new Promise((function(n,r){(function(t,e,i,n){Promise.resolve(n).then((function(e){t({value:e,done:i})}),e)})(n,r,(e=t[i](e)).done,e.value)}))}}}const u=new TextDecoder("utf-8"),d=t=>u.decode(t),h=new TextEncoder,p=t=>h.encode(t),[y,f]=(()=>{const t=()=>{throw new Error("BigInt is not available in this environment")};function e(){throw t()}return e.asIntN=()=>{throw t()},e.asUintN=()=>{throw t()},"undefined"!=typeof BigInt?[BigInt,!0]:[e,!1]})(),[b,m]=(()=>{const t=()=>{throw new Error("BigInt64Array is not available in this environment")};return"undefined"!=typeof BigInt64Array?[BigInt64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),[v,g]=(()=>{const t=()=>{throw new Error("BigUint64Array is not available in this environment")};return"undefined"!=typeof BigUint64Array?[BigUint64Array,!0]:[class{static get BYTES_PER_ELEMENT(){return 8}static of(){throw t()}static from(){throw t()}constructor(){throw t()}},!1]})(),_=t=>"function"==typeof t,w=t=>null!=t&&Object(t)===t,I=t=>w(t)&&_(t.then),S=t=>w(t)&&_(t[Symbol.iterator]),B=t=>w(t)&&_(t[Symbol.asyncIterator]),A=t=>w(t)&&w(t.schema),T=t=>w(t)&&"done"in t&&"value"in t,D=t=>w(t)&&_(t.stat)&&(t=>"number"==typeof t)(t.fd),O=t=>w(t)&&M(t.body),x=t=>"_getDOMStream"in t&&"_getNodeStream"in t,M=t=>w(t)&&_(t.cancel)&&_(t.getReader)&&!x(t),F=t=>w(t)&&_(t.read)&&_(t.pipe)&&(t=>"boolean"==typeof t)(t.readable)&&!x(t),N="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function L(t,e,i=0,n=e.byteLength){const r=t.byteLength,s=new Uint8Array(t.buffer,t.byteOffset,r),o=new Uint8Array(e.buffer,e.byteOffset,Math.min(n,r));return s.set(o,i),t}function U(t,e){const i=function(t){const e=t[0]?[t[0]]:[];let i,n,r,s;for(let o,a,c=0,l=0,u=t.length;++c<u;)o=e[l],a=t[c],!o||!a||o.buffer!==a.buffer||a.byteOffset<o.byteOffset?a&&(e[++l]=a):(({byteOffset:i,byteLength:r}=o),({byteOffset:n,byteLength:s}=a),i+r<n||n+s<i?a&&(e[++l]=a):e[l]=new Uint8Array(o.buffer,i,n-i+s));return e}(t),n=i.reduce(((t,e)=>t+e.byteLength),0);let r,s,o,a=0,c=-1;const l=Math.min(e||Number.POSITIVE_INFINITY,n);for(const u=i.length;++c<u;){if(r=i[c],s=r.subarray(0,Math.min(r.length,l-a)),l<=a+s.length){s.length<r.length?i[c]=r.subarray(s.length):s.length===r.length&&c++,o?L(o,s,a):o=s;break}L(o||(o=new Uint8Array(l)),s,a),a+=s.length}return[o||new Uint8Array(0),i.slice(c),n-(o?o.byteLength:0)]}function C(t,e){let i=T(e)?e.value:e;return i instanceof t?t===Uint8Array?new t(i.buffer,i.byteOffset,i.byteLength):i:i?("string"==typeof i&&(i=p(i)),i instanceof ArrayBuffer||i instanceof N?new t(i):w(n=i)&&_(n.clear)&&_(n.bytes)&&_(n.position)&&_(n.setPosition)&&_(n.capacity)&&_(n.getBufferIdentifier)&&_(n.createLong)?C(t,i.bytes()):ArrayBuffer.isView(i)?i.byteLength<=0?new t(0):new t(i.buffer,i.byteOffset,i.byteLength/t.BYTES_PER_ELEMENT):t.from(i)):new t(0);var n}const E=t=>C(Int32Array,t),R=t=>C(Uint8Array,t),V=t=>(t.next(),t);const z=t=>function*(t,e){const i=function*(t){yield t},n="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof N?i(e):S(e)?e:i(e);return yield*V(function*(e){let i=null;do{i=e.next(yield C(t,i))}while(!i.done)}(n[Symbol.iterator]())),new t}(Uint8Array,t);function P(t,e){return a(this,arguments,(function*(){if(I(e))return yield o(yield o(yield*c(l(P(t,yield o(e))))));const i=function(t){return a(this,arguments,(function*(){yield yield o(yield o(t))}))},n="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof N?i(e):S(e)?function(t){return a(this,arguments,(function*(){yield o(yield*c(l(V(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):B(e)?e:i(e);return yield o(yield*c(l(V(function(e){return a(this,arguments,(function*(){let i=null;do{i=yield o(e.next(yield yield o(C(t,i))))}while(!i.done)}))}(n[Symbol.asyncIterator]()))))),yield o(new t)}))}const j=t=>P(Uint8Array,t);var k={fromIterable:t=>$(function*(t){let e,i,n,r,s=!1,o=[],a=0;function c(){return"peek"===n?U(o,r)[0]:([i,o,a]=U(o,r),i)}({cmd:n,size:r}=yield null);const l=z(t)[Symbol.iterator]();try{do{if(({done:e,value:i}=Number.isNaN(r-a)?l.next():l.next(r-a)),!e&&i.byteLength>0&&(o.push(i),a+=i.byteLength),e||r<=a)do{({cmd:n,size:r}=yield c())}while(r<a)}while(!e)}catch(u){(s=!0)&&"function"==typeof l.throw&&l.throw(u)}finally{!1===s&&"function"==typeof l.return&&l.return(null)}return null}(t)),fromAsyncIterable:t=>$(function(t){return a(this,arguments,(function*(){let e,i,n,r,s=!1,a=[],c=0;function l(){return"peek"===n?U(a,r)[0]:([i,a,c]=U(a,r),i)}({cmd:n,size:r}=yield yield o(null));const u=j(t)[Symbol.asyncIterator]();try{do{if(({done:e,value:i}=Number.isNaN(r-c)?yield o(u.next()):yield o(u.next(r-c))),!e&&i.byteLength>0&&(a.push(i),c+=i.byteLength),e||r<=c)do{({cmd:n,size:r}=yield yield o(l()))}while(r<c)}while(!e)}catch(d){(s=!0)&&"function"==typeof u.throw&&(yield o(u.throw(d)))}finally{!1===s&&"function"==typeof u.return&&(yield o(u.return(new Uint8Array(0))))}return yield o(null)}))}(t)),fromDOMStream:t=>$(function(t){return a(this,arguments,(function*(){let e,i,n,r=!1,s=!1,a=[],c=0;function l(){return"peek"===i?U(a,n)[0]:([e,a,c]=U(a,n),e)}({cmd:i,size:n}=yield yield o(null));const u=new W(t);try{do{if(({done:r,value:e}=Number.isNaN(n-c)?yield o(u.read()):yield o(u.read(n-c))),!r&&e.byteLength>0&&(a.push(R(e)),c+=e.byteLength),r||n<=c)do{({cmd:i,size:n}=yield yield o(l()))}while(n<c)}while(!r)}catch(d){(s=!0)&&(yield o(u.cancel(d)))}finally{!1===s?yield o(u.cancel()):t.locked&&u.releaseLock()}return yield o(null)}))}(t)),fromNodeStream:t=>$(function(t){return a(this,arguments,(function*(){const e=[];let i,n,r,s="error",a=!1,c=null,l=0,u=[];function d(){return"peek"===i?U(u,n)[0]:([r,u,l]=U(u,n),r)}if(({cmd:i,size:n}=yield yield o(null)),t.isTTY)return yield yield o(new Uint8Array(0)),yield o(null);try{e[0]=Y(t,"end"),e[1]=Y(t,"error");do{if(e[2]=Y(t,"readable"),[s,c]=yield o(Promise.race(e.map((t=>t[2])))),"error"===s)break;if((a="end"===s)||(Number.isFinite(n-l)?(r=R(t.read(n-l)),r.byteLength<n-l&&(r=R(t.read()))):r=R(t.read()),r.byteLength>0&&(u.push(r),l+=r.byteLength)),a||n<=l)do{({cmd:i,size:n}=yield yield o(d()))}while(n<l)}while(!a)}finally{yield o(h(e,"error"===s?c:null))}return yield o(null);function h(e,i){return r=u=null,new Promise(((n,r)=>{for(const[i,o]of e)t.off(i,o);try{const e=t.destroy;e&&e.call(t,i),i=void 0}catch(s){i=s||i}finally{null!=i?r(i):n()}}))}}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}};const $=t=>(t.next(),t);class W{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return r(this,void 0,void 0,(function*(){const{reader:e,source:i}=this;e&&(yield e.cancel(t).catch((()=>{}))),i&&i.locked&&this.releaseLock()}))}read(t){return r(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=R(e)),e}))}}const Y=(t,e)=>{const i=t=>n([e,t]);let n;return[e,i,new Promise((r=>(n=r)&&t.once(e,i)))]};var H,K,J,G,Z,q,Q,X,tt,et,it,nt,rt,st,ot,at,ct,lt;(K=H||(H={}))[K.V1=0]="V1",K[K.V2=1]="V2",K[K.V3=2]="V3",K[K.V4=3]="V4",K[K.V5=4]="V5",(G=J||(J={}))[G.Sparse=0]="Sparse",G[G.Dense=1]="Dense",(q=Z||(Z={}))[q.HALF=0]="HALF",q[q.SINGLE=1]="SINGLE",q[q.DOUBLE=2]="DOUBLE",(X=Q||(Q={}))[X.DAY=0]="DAY",X[X.MILLISECOND=1]="MILLISECOND",(et=tt||(tt={}))[et.SECOND=0]="SECOND",et[et.MILLISECOND=1]="MILLISECOND",et[et.MICROSECOND=2]="MICROSECOND",et[et.NANOSECOND=3]="NANOSECOND",(nt=it||(it={}))[nt.YEAR_MONTH=0]="YEAR_MONTH",nt[nt.DAY_TIME=1]="DAY_TIME",nt[nt.MONTH_DAY_NANO=2]="MONTH_DAY_NANO",(st=rt||(rt={}))[st.NONE=0]="NONE",st[st.Schema=1]="Schema",st[st.DictionaryBatch=2]="DictionaryBatch",st[st.RecordBatch=3]="RecordBatch",st[st.Tensor=4]="Tensor",st[st.SparseTensor=5]="SparseTensor",(at=ot||(ot={}))[at.NONE=0]="NONE",at[at.Null=1]="Null",at[at.Int=2]="Int",at[at.Float=3]="Float",at[at.Binary=4]="Binary",at[at.Utf8=5]="Utf8",at[at.Bool=6]="Bool",at[at.Decimal=7]="Decimal",at[at.Date=8]="Date",at[at.Time=9]="Time",at[at.Timestamp=10]="Timestamp",at[at.Interval=11]="Interval",at[at.List=12]="List",at[at.Struct=13]="Struct",at[at.Union=14]="Union",at[at.FixedSizeBinary=15]="FixedSizeBinary",at[at.FixedSizeList=16]="FixedSizeList",at[at.Map=17]="Map",at[at.Dictionary=-1]="Dictionary",at[at.Int8=-2]="Int8",at[at.Int16=-3]="Int16",at[at.Int32=-4]="Int32",at[at.Int64=-5]="Int64",at[at.Uint8=-6]="Uint8",at[at.Uint16=-7]="Uint16",at[at.Uint32=-8]="Uint32",at[at.Uint64=-9]="Uint64",at[at.Float16=-10]="Float16",at[at.Float32=-11]="Float32",at[at.Float64=-12]="Float64",at[at.DateDay=-13]="DateDay",at[at.DateMillisecond=-14]="DateMillisecond",at[at.TimestampSecond=-15]="TimestampSecond",at[at.TimestampMillisecond=-16]="TimestampMillisecond",at[at.TimestampMicrosecond=-17]="TimestampMicrosecond",at[at.TimestampNanosecond=-18]="TimestampNanosecond",at[at.TimeSecond=-19]="TimeSecond",at[at.TimeMillisecond=-20]="TimeMillisecond",at[at.TimeMicrosecond=-21]="TimeMicrosecond",at[at.TimeNanosecond=-22]="TimeNanosecond",at[at.DenseUnion=-23]="DenseUnion",at[at.SparseUnion=-24]="SparseUnion",at[at.IntervalDayTime=-25]="IntervalDayTime",at[at.IntervalYearMonth=-26]="IntervalYearMonth",(lt=ct||(ct={}))[lt.OFFSET=0]="OFFSET",lt[lt.DATA=1]="DATA",lt[lt.VALIDITY=2]="VALIDITY",lt[lt.TYPE=3]="TYPE";function ut(t){if(null===t)return"null";if(undefined===t)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>ut(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}const dt=Symbol.for("isArrowBigNum");function ht(t,...e){return 0===e.length?Object.setPrototypeOf(C(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function pt(...t){return ht.apply(this,t)}function yt(...t){return ht.apply(this,t)}function ft(...t){return ht.apply(this,t)}function bt(t){const{buffer:e,byteOffset:i,length:n,signed:r}=t,s=new Int32Array(e,i,n);let o=0,a=0;const c=s.length;let l,u;for(;a<c;)u=s[a++],l=s[a++],r||(l>>>=0),o+=(u>>>0)+l*Math.pow(a,32);return o}let mt,vt;function gt(t){let e="";const i=new Uint32Array(2);let n=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const r=new Uint32Array((n=new Uint16Array(n).reverse()).buffer);let s=-1;const o=n.length-1;do{for(i[0]=n[s=0];s<o;)n[s++]=i[1]=i[0]/10,i[0]=(i[0]-10*i[1]<<16)+n[s];n[s]=i[1]=i[0]/10,i[0]=i[0]-10*i[1],e=`${i[0]}${e}`}while(r[0]||r[1]||r[2]||r[3]);return e||"0"}ht.prototype[dt]=!0,ht.prototype.toJSON=function(){return`"${mt(this)}"`},ht.prototype.valueOf=function(){return bt(this)},ht.prototype.toString=function(){return mt(this)},ht.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return bt(this);case"string":return mt(this);case"default":return vt(this)}return mt(this)},Object.setPrototypeOf(pt.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(yt.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(ft.prototype,Object.create(Uint32Array.prototype)),Object.assign(pt.prototype,ht.prototype,{constructor:pt,signed:!0,TypedArray:Int32Array,BigIntArray:b}),Object.assign(yt.prototype,ht.prototype,{constructor:yt,signed:!1,TypedArray:Uint32Array,BigIntArray:v}),Object.assign(ft.prototype,ht.prototype,{constructor:ft,signed:!0,TypedArray:Uint32Array,BigIntArray:v}),f?(vt=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:gt(t),mt=t=>8===t.byteLength?`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`:gt(t)):(mt=gt,vt=mt);class _t{static new(t,e){switch(e){case!0:return new pt(t);case!1:return new yt(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case b:return new pt(t)}return 16===t.byteLength?new ft(t):new yt(t)}static signed(t){return new pt(t)}static unsigned(t){return new yt(t)}static decimal(t){return new ft(t)}constructor(t,e){return _t.new(t,e)}}var wt,It,St,Bt,At,Tt,Dt,Ot,xt,Mt,Ft,Nt,Lt,Ut,Ct,Et,Rt,Vt,zt,Pt;class jt{static isNull(t){return(null==t?void 0:t.typeId)===ot.Null}static isInt(t){return(null==t?void 0:t.typeId)===ot.Int}static isFloat(t){return(null==t?void 0:t.typeId)===ot.Float}static isBinary(t){return(null==t?void 0:t.typeId)===ot.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===ot.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===ot.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===ot.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===ot.Date}static isTime(t){return(null==t?void 0:t.typeId)===ot.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===ot.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===ot.Interval}static isList(t){return(null==t?void 0:t.typeId)===ot.List}static isStruct(t){return(null==t?void 0:t.typeId)===ot.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===ot.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===ot.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===ot.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===ot.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===ot.Dictionary}static isDenseUnion(t){return jt.isUnion(t)&&t.mode===J.Dense}static isSparseUnion(t){return jt.isUnion(t)&&t.mode===J.Sparse}get typeId(){return ot.NONE}}wt=Symbol.toStringTag,jt[wt]=((Pt=jt.prototype).children=null,Pt.ArrayType=Array,Pt[Symbol.toStringTag]="DataType");class kt extends jt{toString(){return"Null"}get typeId(){return ot.Null}}It=Symbol.toStringTag,kt[It]=kt.prototype[Symbol.toStringTag]="Null";class $t extends jt{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return ot.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}St=Symbol.toStringTag,$t[St]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))($t.prototype);class Wt extends $t{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}Object.defineProperty(class extends $t{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(class extends $t{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(Wt.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(class extends $t{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(class extends $t{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(class extends $t{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends $t{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(class extends $t{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}.prototype,"ArrayType",{value:BigUint64Array});class Yt extends jt{constructor(t){super(),this.precision=t}get typeId(){return ot.Float}get ArrayType(){switch(this.precision){case Z.HALF:return Uint16Array;case Z.SINGLE:return Float32Array;case Z.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Bt=Symbol.toStringTag,Yt[Bt]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(Yt.prototype);Object.defineProperty(class extends Yt{constructor(){super(Z.HALF)}}.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(class extends Yt{constructor(){super(Z.SINGLE)}}.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(class extends Yt{constructor(){super(Z.DOUBLE)}}.prototype,"ArrayType",{value:Float64Array});class Ht extends jt{constructor(){super()}get typeId(){return ot.Binary}toString(){return"Binary"}}At=Symbol.toStringTag,Ht[At]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(Ht.prototype);class Kt extends jt{constructor(){super()}get typeId(){return ot.Utf8}toString(){return"Utf8"}}Tt=Symbol.toStringTag,Kt[Tt]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(Kt.prototype);class Jt extends jt{constructor(){super()}get typeId(){return ot.Bool}toString(){return"Bool"}}Dt=Symbol.toStringTag,Jt[Dt]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(Jt.prototype);class Gt extends jt{constructor(t,e,i=128){super(),this.scale=t,this.precision=e,this.bitWidth=i}get typeId(){return ot.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}Ot=Symbol.toStringTag,Gt[Ot]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(Gt.prototype);class Zt extends jt{constructor(t){super(),this.unit=t}get typeId(){return ot.Date}toString(){return`Date${32*(this.unit+1)}<${Q[this.unit]}>`}}xt=Symbol.toStringTag,Zt[xt]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(Zt.prototype);class qt extends jt{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return ot.Time}toString(){return`Time${this.bitWidth}<${tt[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Mt=Symbol.toStringTag,qt[Mt]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(qt.prototype);class Qt extends jt{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return ot.Timestamp}toString(){return`Timestamp<${tt[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Ft=Symbol.toStringTag,Qt[Ft]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Qt.prototype);class Xt extends jt{constructor(t){super(),this.unit=t}get typeId(){return ot.Interval}toString(){return`Interval<${it[this.unit]}>`}}Nt=Symbol.toStringTag,Xt[Nt]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Xt.prototype);class te extends jt{constructor(t){super(),this.children=[t]}get typeId(){return ot.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Lt=Symbol.toStringTag,te[Lt]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(te.prototype);class ee extends jt{constructor(t){super(),this.children=t}get typeId(){return ot.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Ut=Symbol.toStringTag,ee[Ut]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(ee.prototype);class ie extends jt{constructor(t,e,i){super(),this.mode=t,this.children=i,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,i)=>(t[e]=i)&&t||t),Object.create(null))}get typeId(){return ot.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}Ct=Symbol.toStringTag,ie[Ct]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))(ie.prototype);class ne extends jt{constructor(t){super(),this.byteWidth=t}get typeId(){return ot.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Et=Symbol.toStringTag,ne[Et]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(ne.prototype);class re extends jt{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return ot.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Rt=Symbol.toStringTag,re[Rt]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(re.prototype);class se extends jt{constructor(t,e=!1){super(),this.children=[t],this.keysSorted=e}get typeId(){return ot.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Vt=Symbol.toStringTag,se[Vt]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(se.prototype);const oe=(ae=-1,()=>++ae);var ae;class ce extends jt{constructor(t,e,i,n){super(),this.indices=e,this.dictionary=t,this.isOrdered=n||!1,this.id=null==i?oe():"number"==typeof i?i:i.low}get typeId(){return ot.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function le(t){const e=t;switch(t.typeId){case ot.Decimal:return t.bitWidth/32;case ot.Timestamp:return 2;case ot.Date:case ot.Interval:return 1+e.unit;case ot.FixedSizeList:return e.listSize;case ot.FixedSizeBinary:return e.byteWidth;default:return 1}}zt=Symbol.toStringTag,ce[zt]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(ce.prototype);class ue{visitMany(t,...e){return t.map(((t,i)=>this.visit(t,...e.map((t=>t[i])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,i=!0){if("number"==typeof e)return de(t,e,i);if("string"==typeof e&&e in ot)return de(t,ot[e],i);if(e&&e instanceof jt)return de(t,he(e),i);if((null==e?void 0:e.type)&&e.type instanceof jt)return de(t,he(e.type),i);return de(t,ot.NONE,i)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return de(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function de(t,e,i=!0){let n=null;switch(e){case ot.Null:n=t.visitNull;break;case ot.Bool:n=t.visitBool;break;case ot.Int:n=t.visitInt;break;case ot.Int8:n=t.visitInt8||t.visitInt;break;case ot.Int16:n=t.visitInt16||t.visitInt;break;case ot.Int32:n=t.visitInt32||t.visitInt;break;case ot.Int64:n=t.visitInt64||t.visitInt;break;case ot.Uint8:n=t.visitUint8||t.visitInt;break;case ot.Uint16:n=t.visitUint16||t.visitInt;break;case ot.Uint32:n=t.visitUint32||t.visitInt;break;case ot.Uint64:n=t.visitUint64||t.visitInt;break;case ot.Float:n=t.visitFloat;break;case ot.Float16:n=t.visitFloat16||t.visitFloat;break;case ot.Float32:n=t.visitFloat32||t.visitFloat;break;case ot.Float64:n=t.visitFloat64||t.visitFloat;break;case ot.Utf8:n=t.visitUtf8;break;case ot.Binary:n=t.visitBinary;break;case ot.FixedSizeBinary:n=t.visitFixedSizeBinary;break;case ot.Date:n=t.visitDate;break;case ot.DateDay:n=t.visitDateDay||t.visitDate;break;case ot.DateMillisecond:n=t.visitDateMillisecond||t.visitDate;break;case ot.Timestamp:n=t.visitTimestamp;break;case ot.TimestampSecond:n=t.visitTimestampSecond||t.visitTimestamp;break;case ot.TimestampMillisecond:n=t.visitTimestampMillisecond||t.visitTimestamp;break;case ot.TimestampMicrosecond:n=t.visitTimestampMicrosecond||t.visitTimestamp;break;case ot.TimestampNanosecond:n=t.visitTimestampNanosecond||t.visitTimestamp;break;case ot.Time:n=t.visitTime;break;case ot.TimeSecond:n=t.visitTimeSecond||t.visitTime;break;case ot.TimeMillisecond:n=t.visitTimeMillisecond||t.visitTime;break;case ot.TimeMicrosecond:n=t.visitTimeMicrosecond||t.visitTime;break;case ot.TimeNanosecond:n=t.visitTimeNanosecond||t.visitTime;break;case ot.Decimal:n=t.visitDecimal;break;case ot.List:n=t.visitList;break;case ot.Struct:n=t.visitStruct;break;case ot.Union:n=t.visitUnion;break;case ot.DenseUnion:n=t.visitDenseUnion||t.visitUnion;break;case ot.SparseUnion:n=t.visitSparseUnion||t.visitUnion;break;case ot.Dictionary:n=t.visitDictionary;break;case ot.Interval:n=t.visitInterval;break;case ot.IntervalDayTime:n=t.visitIntervalDayTime||t.visitInterval;break;case ot.IntervalYearMonth:n=t.visitIntervalYearMonth||t.visitInterval;break;case ot.FixedSizeList:n=t.visitFixedSizeList;break;case ot.Map:n=t.visitMap}if("function"==typeof n)return n;if(!i)return()=>null;throw new Error(`Unrecognized type '${ot[e]}'`)}function he(t){switch(t.typeId){case ot.Null:return ot.Null;case ot.Int:{const{bitWidth:e,isSigned:i}=t;switch(e){case 8:return i?ot.Int8:ot.Uint8;case 16:return i?ot.Int16:ot.Uint16;case 32:return i?ot.Int32:ot.Uint32;case 64:return i?ot.Int64:ot.Uint64}return ot.Int}case ot.Float:switch(t.precision){case Z.HALF:return ot.Float16;case Z.SINGLE:return ot.Float32;case Z.DOUBLE:return ot.Float64}return ot.Float;case ot.Binary:return ot.Binary;case ot.Utf8:return ot.Utf8;case ot.Bool:return ot.Bool;case ot.Decimal:return ot.Decimal;case ot.Time:switch(t.unit){case tt.SECOND:return ot.TimeSecond;case tt.MILLISECOND:return ot.TimeMillisecond;case tt.MICROSECOND:return ot.TimeMicrosecond;case tt.NANOSECOND:return ot.TimeNanosecond}return ot.Time;case ot.Timestamp:switch(t.unit){case tt.SECOND:return ot.TimestampSecond;case tt.MILLISECOND:return ot.TimestampMillisecond;case tt.MICROSECOND:return ot.TimestampMicrosecond;case tt.NANOSECOND:return ot.TimestampNanosecond}return ot.Timestamp;case ot.Date:switch(t.unit){case Q.DAY:return ot.DateDay;case Q.MILLISECOND:return ot.DateMillisecond}return ot.Date;case ot.Interval:switch(t.unit){case it.DAY_TIME:return ot.IntervalDayTime;case it.YEAR_MONTH:return ot.IntervalYearMonth}return ot.Interval;case ot.Map:return ot.Map;case ot.List:return ot.List;case ot.Struct:return ot.Struct;case ot.Union:switch(t.mode){case J.Dense:return ot.DenseUnion;case J.Sparse:return ot.SparseUnion}return ot.Union;case ot.FixedSizeBinary:return ot.FixedSizeBinary;case ot.FixedSizeList:return ot.FixedSizeList;case ot.Dictionary:return ot.Dictionary}throw new Error(`Unrecognized type '${ot[t.typeId]}'`)}ue.prototype.visitInt8=null,ue.prototype.visitInt16=null,ue.prototype.visitInt32=null,ue.prototype.visitInt64=null,ue.prototype.visitUint8=null,ue.prototype.visitUint16=null,ue.prototype.visitUint32=null,ue.prototype.visitUint64=null,ue.prototype.visitFloat16=null,ue.prototype.visitFloat32=null,ue.prototype.visitFloat64=null,ue.prototype.visitDateDay=null,ue.prototype.visitDateMillisecond=null,ue.prototype.visitTimestampSecond=null,ue.prototype.visitTimestampMillisecond=null,ue.prototype.visitTimestampMicrosecond=null,ue.prototype.visitTimestampNanosecond=null,ue.prototype.visitTimeSecond=null,ue.prototype.visitTimeMillisecond=null,ue.prototype.visitTimeMicrosecond=null,ue.prototype.visitTimeNanosecond=null,ue.prototype.visitDenseUnion=null,ue.prototype.visitSparseUnion=null,ue.prototype.visitIntervalDayTime=null,ue.prototype.visitIntervalYearMonth=null;const pe=new Float64Array(1),ye=new Uint32Array(pe.buffer);function fe(t){const e=(31744&t)>>10,i=(1023&t)/1024,n=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return n*(i?Number.NaN:1/0);case 0:return n*(i?6103515625e-14*i:0)}return n*Math.pow(2,e-15)*(1+i)}class be extends ue{}function me(t){return(e,i,n)=>{if(e.setValid(i,null!=n))return t(e,i,n)}}const ve=(t,e,i)=>{t[e]=Math.trunc(i%4294967296),t[e+1]=Math.trunc(i/4294967296)},ge=(t,e,i,n)=>{const{[i]:r,[i+1]:s}=e;null!=r&&null!=s&&t.set(n.subarray(0,s-r),r)},_e=({values:t},e,i)=>{t[e]=i},we=({values:t},e,i)=>{t[e]=i},Ie=({values:t},e,i)=>{t[e]=function(t){if(t!=t)return 32256;pe[0]=t;const e=(2147483648&ye[1])>>16&65535;let i=2146435072&ye[1],n=0;return i>=1089470464?ye[0]>0?i=31744:(i=(2080374784&i)>>16,n=(1048575&ye[1])>>10):i<=1056964608?(n=1048576+(1048575&ye[1]),n=1048576+(n<<(i>>20)-998)>>21,i=0):(i=i-1056964608>>10,n=512+(1048575&ye[1])>>10),e|i|65535&n}(i)},Se=({values:t},e,i)=>{((t,e,i)=>{t[e]=Math.trunc(i/864e5)})(t,e,i.valueOf())},Be=({values:t},e,i)=>{ve(t,2*e,i.valueOf())},Ae=({values:t},e,i)=>ve(t,2*e,i/1e3),Te=({values:t},e,i)=>ve(t,2*e,i),De=({values:t},e,i)=>((t,e,i)=>{t[e]=Math.trunc(1e3*i%4294967296),t[e+1]=Math.trunc(1e3*i/4294967296)})(t,2*e,i),Oe=({values:t},e,i)=>((t,e,i)=>{t[e]=Math.trunc(1e6*i%4294967296),t[e+1]=Math.trunc(1e6*i/4294967296)})(t,2*e,i),xe=({values:t},e,i)=>{t[e]=i},Me=({values:t},e,i)=>{t[e]=i},Fe=({values:t},e,i)=>{t[e]=i},Ne=({values:t},e,i)=>{t[e]=i},Le=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];Re.visit(r,t.valueOffsets[e],i)},Ue=(t,e,i)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];Re.visit(r,e,i)},Ce=({values:t},e,i)=>{t.set(i.subarray(0,2),2*e)},Ee=({values:t},e,i)=>{t[e]=12*i[0]+i[1]%12};be.prototype.visitBool=me((({offset:t,values:e},i,n)=>{const r=t+i;n?e[r>>3]|=1<<r%8:e[r>>3]&=~(1<<r%8)})),be.prototype.visitInt=me(_e),be.prototype.visitInt8=me(_e),be.prototype.visitInt16=me(_e),be.prototype.visitInt32=me(_e),be.prototype.visitInt64=me(_e),be.prototype.visitUint8=me(_e),be.prototype.visitUint16=me(_e),be.prototype.visitUint32=me(_e),be.prototype.visitUint64=me(_e),be.prototype.visitFloat=me(((t,e,i)=>{switch(t.type.precision){case Z.HALF:return Ie(t,e,i);case Z.SINGLE:case Z.DOUBLE:default:return we(t,e,i)}})),be.prototype.visitFloat16=me(Ie),be.prototype.visitFloat32=me(we),be.prototype.visitFloat64=me(we),be.prototype.visitUtf8=me((({values:t,valueOffsets:e},i,n)=>{ge(t,e,i,p(n))})),be.prototype.visitBinary=me((({values:t,valueOffsets:e},i,n)=>ge(t,e,i,n))),be.prototype.visitFixedSizeBinary=me((({stride:t,values:e},i,n)=>{e.set(n.subarray(0,t),t*i)})),be.prototype.visitDate=me(((t,e,i)=>{t.type.unit===Q.DAY?Se(t,e,i):Be(t,e,i)})),be.prototype.visitDateDay=me(Se),be.prototype.visitDateMillisecond=me(Be),be.prototype.visitTimestamp=me(((t,e,i)=>{switch(t.type.unit){case tt.SECOND:return Ae(t,e,i);case tt.MILLISECOND:return Te(t,e,i);case tt.MICROSECOND:return De(t,e,i);case tt.NANOSECOND:return Oe(t,e,i)}})),be.prototype.visitTimestampSecond=me(Ae),be.prototype.visitTimestampMillisecond=me(Te),be.prototype.visitTimestampMicrosecond=me(De),be.prototype.visitTimestampNanosecond=me(Oe),be.prototype.visitTime=me(((t,e,i)=>{switch(t.type.unit){case tt.SECOND:return xe(t,e,i);case tt.MILLISECOND:return Me(t,e,i);case tt.MICROSECOND:return Fe(t,e,i);case tt.NANOSECOND:return Ne(t,e,i)}})),be.prototype.visitTimeSecond=me(xe),be.prototype.visitTimeMillisecond=me(Me),be.prototype.visitTimeMicrosecond=me(Fe),be.prototype.visitTimeNanosecond=me(Ne),be.prototype.visitDecimal=me((({values:t,stride:e},i,n)=>{t.set(n.subarray(0,e),e*i)})),be.prototype.visitList=me(((t,e,i)=>{const n=t.children[0],r=t.valueOffsets,s=Re.getVisitFn(n);if(Array.isArray(i))for(let o=-1,a=r[e],c=r[e+1];a<c;)s(n,a++,i[++o]);else for(let o=-1,a=r[e],c=r[e+1];a<c;)s(n,a++,i.get(++o))})),be.prototype.visitStruct=me(((t,e,i)=>{const n=t.type.children.map((t=>Re.getVisitFn(t.type))),r=i instanceof Map?(s=e,o=i,(t,e,i,n)=>e&&t(e,s,o.get(i.name))):i instanceof nn?((t,e)=>(i,n,r,s)=>n&&i(n,t,e.get(s)))(e,i):Array.isArray(i)?((t,e)=>(i,n,r,s)=>n&&i(n,t,e[s]))(e,i):((t,e)=>(i,n,r,s)=>n&&i(n,t,e[r.name]))(e,i);var s,o;t.type.children.forEach(((e,i)=>r(n[i],t.children[i],e,i)))})),be.prototype.visitUnion=me(((t,e,i)=>{t.type.mode===J.Dense?Le(t,e,i):Ue(t,e,i)})),be.prototype.visitDenseUnion=me(Le),be.prototype.visitSparseUnion=me(Ue),be.prototype.visitDictionary=me(((t,e,i)=>{var n;null===(n=t.dictionary)||void 0===n||n.set(t.values[e],i)})),be.prototype.visitInterval=me(((t,e,i)=>{t.type.unit===it.DAY_TIME?Ce(t,e,i):Ee(t,e,i)})),be.prototype.visitIntervalDayTime=me(Ce),be.prototype.visitIntervalYearMonth=me(Ee),be.prototype.visitFixedSizeList=me(((t,e,i)=>{const{stride:n}=t,r=t.children[0],s=Re.getVisitFn(r);if(Array.isArray(i))for(let o=-1,a=e*n;++o<n;)s(r,a+o,i[o]);else for(let o=-1,a=e*n;++o<n;)s(r,a+o,i.get(o))})),be.prototype.visitMap=me(((t,e,i)=>{const n=t.children[0],r=t.valueOffsets,s=Re.getVisitFn(n);let{[e]:o,[e+1]:a}=r;const c=i instanceof Map?i.entries():Object.entries(i);for(const l of c)if(s(n,o,l),++o>=a)break}));const Re=new be,Ve=Symbol.for("parent"),ze=Symbol.for("rowIndex");class Pe{constructor(t,e){return this[Ve]=t,this[ze]=e,new Proxy(this,new ke)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[ze],e=this[Ve],i=e.type.children,n={};for(let r=-1,s=i.length;++r<s;)n[i[r].name]=ui.visit(e.children[r],t);return n}toString(){return`{${[...this].map((([t,e])=>`${ut(t)}: ${ut(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new je(this[Ve],this[ze])}}class je{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,ui.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Pe.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Ve]:{writable:!0,enumerable:!1,configurable:!1,value:null},[ze]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class ke{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Ve].type.children.map((t=>t.name))}has(t,e){return-1!==t[Ve].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[Ve].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[Ve].type.children.findIndex((t=>t.name===e));if(-1!==i){const n=ui.visit(t[Ve].children[i],t[ze]);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[Ve].type.children.findIndex((t=>t.name===e));return-1!==n?(Re.visit(t[Ve].children[n],t[ze],i),Reflect.set(t,e,i)):!!Reflect.has(t,e)&&Reflect.set(t,e,i)}}class $e extends ue{}function We(t){return(e,i)=>e.getValid(i)?t(e,i):null}const Ye=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),He=t=>new Date(t),Ke=(t,e,i)=>{const{[i]:n,[i+1]:r}=e;return null!=n&&null!=r?t.subarray(n,r):null},Je=({values:t},e)=>((t,e)=>He(((t,e)=>864e5*t[e])(t,e)))(t,e),Ge=({values:t},e)=>((t,e)=>He(Ye(t,e)))(t,2*e),Ze=({stride:t,values:e},i)=>e[t*i],qe=({values:t},e)=>t[e],Qe=({values:t},e)=>1e3*Ye(t,2*e),Xe=({values:t},e)=>Ye(t,2*e),ti=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),ei=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),ii=({values:t},e)=>t[e],ni=({values:t},e)=>t[e],ri=({values:t},e)=>t[e],si=({values:t},e)=>t[e],oi=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return ui.visit(n,t.valueOffsets[e])},ai=(t,e)=>{const i=t.type.typeIdToChildIndex[t.typeIds[e]],n=t.children[i];return ui.visit(n,e)},ci=({values:t},e)=>t.subarray(2*e,2*(e+1)),li=({values:t},e)=>{const i=t[e],n=new Int32Array(2);return n[0]=Math.trunc(i/12),n[1]=Math.trunc(i%12),n};$e.prototype.visitNull=We(((t,e)=>null)),$e.prototype.visitBool=We((({offset:t,values:e},i)=>{const n=t+i;return 0!=(e[n>>3]&1<<n%8)})),$e.prototype.visitInt=We((({values:t},e)=>t[e])),$e.prototype.visitInt8=We(Ze),$e.prototype.visitInt16=We(Ze),$e.prototype.visitInt32=We(Ze),$e.prototype.visitInt64=We(qe),$e.prototype.visitUint8=We(Ze),$e.prototype.visitUint16=We(Ze),$e.prototype.visitUint32=We(Ze),$e.prototype.visitUint64=We(qe),$e.prototype.visitFloat=We((({type:t,values:e},i)=>t.precision!==Z.HALF?e[i]:fe(e[i]))),$e.prototype.visitFloat16=We((({stride:t,values:e},i)=>fe(e[t*i]))),$e.prototype.visitFloat32=We(Ze),$e.prototype.visitFloat64=We(Ze),$e.prototype.visitUtf8=We((({values:t,valueOffsets:e},i)=>{const n=Ke(t,e,i);return null!==n?d(n):null})),$e.prototype.visitBinary=We((({values:t,valueOffsets:e},i)=>Ke(t,e,i))),$e.prototype.visitFixedSizeBinary=We((({stride:t,values:e},i)=>e.subarray(t*i,t*(i+1)))),$e.prototype.visitDate=We(((t,e)=>t.type.unit===Q.DAY?Je(t,e):Ge(t,e))),$e.prototype.visitDateDay=We(Je),$e.prototype.visitDateMillisecond=We(Ge),$e.prototype.visitTimestamp=We(((t,e)=>{switch(t.type.unit){case tt.SECOND:return Qe(t,e);case tt.MILLISECOND:return Xe(t,e);case tt.MICROSECOND:return ti(t,e);case tt.NANOSECOND:return ei(t,e)}})),$e.prototype.visitTimestampSecond=We(Qe),$e.prototype.visitTimestampMillisecond=We(Xe),$e.prototype.visitTimestampMicrosecond=We(ti),$e.prototype.visitTimestampNanosecond=We(ei),$e.prototype.visitTime=We(((t,e)=>{switch(t.type.unit){case tt.SECOND:return ii(t,e);case tt.MILLISECOND:return ni(t,e);case tt.MICROSECOND:return ri(t,e);case tt.NANOSECOND:return si(t,e)}})),$e.prototype.visitTimeSecond=We(ii),$e.prototype.visitTimeMillisecond=We(ni),$e.prototype.visitTimeMicrosecond=We(ri),$e.prototype.visitTimeNanosecond=We(si),$e.prototype.visitDecimal=We((({values:t,stride:e},i)=>_t.decimal(t.subarray(e*i,e*(i+1))))),$e.prototype.visitList=We(((t,e)=>{const{valueOffsets:i,stride:n}=t,{[e*n]:r}=i,{[e*n+1]:s}=i,o=t.children[0].slice(r,s-r);return new nn([o])})),$e.prototype.visitStruct=We(((t,e)=>new Pe(t,e))),$e.prototype.visitUnion=We(((t,e)=>t.type.mode===J.Dense?oi(t,e):ai(t,e))),$e.prototype.visitDenseUnion=We(oi),$e.prototype.visitSparseUnion=We(ai),$e.prototype.visitDictionary=We(((t,e)=>{var i;return null===(i=t.dictionary)||void 0===i?void 0:i.get(t.values[e])})),$e.prototype.visitInterval=We(((t,e)=>t.type.unit===it.DAY_TIME?ci(t,e):li(t,e))),$e.prototype.visitIntervalDayTime=We(ci),$e.prototype.visitIntervalYearMonth=We(li),$e.prototype.visitFixedSizeList=We(((t,e)=>{const{stride:i}=t,n=t.children[0].slice(e*i,i);return new nn([n])})),$e.prototype.visitMap=We(((t,e)=>{const{valueOffsets:i}=t,{[e]:n}=i,{[e+1]:r}=i,s=t.children[0];return new pi(s.slice(n,r-n))}));const ui=new $e,di=Symbol.for("keys"),hi=Symbol.for("vals");class pi{constructor(t){return this[di]=new nn([t.children[0]]).memoize(),this[hi]=t.children[1],new Proxy(this,new fi)}[Symbol.iterator](){return new yi(this[di],this[hi])}get size(){return this[di].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[di],e=this[hi],i={};for(let n=-1,r=t.length;++n<r;)i[t.get(n)]=ui.visit(e,n);return i}toString(){return`{${[...this].map((([t,e])=>`${ut(t)}: ${ut(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class yi{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),ui.visit(this.vals,t)]})}}class fi{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[di].toArray().map(String)}has(t,e){return t[di].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[di].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const i=t[di].indexOf(e);if(-1!==i){const n=ui.visit(Reflect.get(t,hi),i);return Reflect.set(t,e,n),n}}set(t,e,i){const n=t[di].indexOf(e);return-1!==n?(Re.visit(Reflect.get(t,hi),n,i),Reflect.set(t,e,i)):!!Reflect.has(t,e)&&Reflect.set(t,e,i)}}let bi;function mi(t,e,i,n){const{length:r=0}=t;let s="number"!=typeof e?0:e,o="number"!=typeof i?r:i;return s<0&&(s=(s%r+r)%r),o<0&&(o=(o%r+r)%r),o<s&&(bi=s,s=o,o=bi),o>r&&(o=r),n?n(t,s,o):[s,o]}Object.defineProperties(pi.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[di]:{writable:!0,enumerable:!1,configurable:!1,value:null},[hi]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const vi=t=>t!=t;function gi(t){if("object"!==typeof t||null===t)return vi(t)?vi:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let i=0;const n=t.length;if(n!==e.length)return!1;if(n>0)do{if(t[i]!==e[i])return!1}while(++i<n);return!0}(t,e):t instanceof Map?function(t){let e=-1;const i=[];for(const n of t.values())i[++e]=gi(n);return _i(i)}(t):Array.isArray(t)?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=gi(t[i]);return _i(e)}(t):t instanceof nn?function(t){const e=[];for(let i=-1,n=t.length;++i<n;)e[i]=gi(t.get(i));return _i(e)}(t):function(t,e=!1){const i=Object.keys(t);if(!e&&0===i.length)return()=>!1;const n=[];for(let r=-1,s=i.length;++r<s;)n[r]=gi(t[i[r]]);return _i(n,i)}(t,!0)}function _i(t,e){return i=>{if(!i||"object"!=typeof i)return!1;switch(i.constructor){case Array:return function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e[n]))return!1;return!0}(t,i);case Map:return wi(t,i,i.keys());case pi:case Pe:case Object:case void 0:return wi(t,i,e||Object.keys(i))}return i instanceof nn&&function(t,e){const i=t.length;if(e.length!==i)return!1;for(let n=-1;++n<i;)if(!t[n](e.get(n)))return!1;return!0}(t,i)}}function wi(t,e,i){const n=i[Symbol.iterator](),r=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),s=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let o=0;const a=t.length;let c=s.next(),l=n.next(),u=r.next();for(;o<a&&!l.done&&!u.done&&!c.done&&(l.value===u.value&&t[o](c.value));++o,l=n.next(),u=r.next(),c=s.next());return!!(o===a&&l.done&&u.done&&c.done)||(n.return&&n.return(),r.return&&r.return(),s.return&&s.return(),!1)}function Ii(t,e,i,n){return 0!=(i&1<<n)}function Si(t,e,i,n){return(i&1<<n)>>n}function Bi(t){const e=[];let i=0,n=0,r=0;for(const o of t)o&&(r|=1<<n),8==++n&&(e[i++]=r,r=n=0);(0===i||n>0)&&(e[i++]=r);const s=new Uint8Array(e.length+7&-8);return s.set(e),s}class Ai{constructor(t,e,i,n,r){this.bytes=t,this.length=i,this.context=n,this.get=r,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Ti(t,e,i){if(i-e<=0)return 0;if(i-e<8){let n=0;for(const r of new Ai(t,e,i-e,t,Si))n+=r;return n}const n=i>>3<<3,r=e+(e%8==0?0:8-e%8);return Ti(t,e,r)+Ti(t,n,i)+function(t,e,i){let n=0,r=Math.trunc(e);const s=new DataView(t.buffer,t.byteOffset,t.byteLength),o=void 0===i?t.byteLength:r+i;for(;o-r>=4;)n+=Di(s.getUint32(r)),r+=4;for(;o-r>=2;)n+=Di(s.getUint16(r)),r+=2;for(;o-r>=1;)n+=Di(s.getUint8(r)),r+=1;return n}(t,r>>3,n-r>>3)}function Di(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class Oi{constructor(t,e,i,n,r,s=[],o){let a;this.type=t,this.children=s,this.dictionary=o,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(i||0,0)),this._nullCount=Math.floor(Math.max(n||0,-1)),r instanceof Oi?(this.stride=r.stride,this.values=r.values,this.typeIds=r.typeIds,this.nullBitmap=r.nullBitmap,this.valueOffsets=r.valueOffsets):(this.stride=le(t),r&&((a=r[0])&&(this.valueOffsets=a),(a=r[1])&&(this.values=a),(a=r[2])&&(this.nullBitmap=a),(a=r[3])&&(this.typeIds=a))),this.nullable=0!==this._nullCount&&this.nullBitmap&&this.nullBitmap.byteLength>0}get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get byteLength(){let t=0;const{valueOffsets:e,values:i,nullBitmap:n,typeIds:r}=this;return e&&(t+=e.byteLength),i&&(t+=i.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-Ti(t,this.offset,this.offset+this.length)),e}getValid(t){if(this.nullable&&this.nullCount>0){const e=this.offset+t;return 0!=(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){if(!this.nullable)return e;if(!this.nullBitmap||this.nullBitmap.byteLength<=t>>3){const{nullBitmap:t}=this._changeLengthAndBackfillNullBitmap(this.length);Object.assign(this,{nullBitmap:t,_nullCount:0})}const{nullBitmap:i,offset:n}=this,r=n+t>>3,s=(n+t)%8,o=i[r]>>s&1;return e?0===o&&(i[r]|=1<<s,this._nullCount=this.nullCount+1):1===o&&(i[r]&=~(1<<s),this._nullCount=this.nullCount-1),e}clone(t=this.type,e=this.offset,i=this.length,n=this._nullCount,r=this,s=this.children){return new Oi(t,e,i,n,r,s,this.dictionary)}slice(t,e){const{stride:i,typeId:n,children:r}=this,s=+(0===this._nullCount)-1,o=16===n?i:1,a=this._sliceBuffers(t,e,i,n);return this.clone(this.type,this.offset+t,e,s,a,0===r.length||this.valueOffsets?r:this._sliceChildren(r,o*t,o*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===ot.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:i}=this,n=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);n[e>>3]=(1<<e-(-8&e))-1,i>0&&n.set(function(t,e,i){const n=i.byteLength+7&-8;if(t>0||i.byteLength<n){const r=new Uint8Array(n);return r.set(t%8==0?i.subarray(t>>3):Bi(new Ai(i,t,e,null,Ii)).subarray(0,n)),r}return i}(this.offset,e,this.nullBitmap),0);const r=this.buffers;return r[ct.VALIDITY]=n,this.clone(this.type,0,t,i+(t-e),r)}_sliceBuffers(t,e,i,n){let r;const{buffers:s}=this;return(r=s[ct.TYPE])&&(s[ct.TYPE]=r.subarray(t,t+e)),(r=s[ct.OFFSET])&&(s[ct.OFFSET]=r.subarray(t,t+e+1))||(r=s[ct.DATA])&&(s[ct.DATA]=6===n?r:r.subarray(i*t,i*(t+e))),s}_sliceChildren(t,e,i){return t.map((t=>t.slice(e,i)))}}Oi.prototype.children=Object.freeze([]);class xi extends ue{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:i=0,length:n=0}=t;return new Oi(e,i,n,0)}visitBool(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length>>3,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitInt(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitFloat(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length,nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitUtf8(t){const{type:e,offset:i=0}=t,n=R(t.data),r=R(t.nullBitmap),s=E(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,o,a,[s,n,r])}visitBinary(t){const{type:e,offset:i=0}=t,n=R(t.data),r=R(t.nullBitmap),s=E(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,o,a,[s,n,r])}visitFixedSizeBinary(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitDate(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitTimestamp(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitTime(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitDecimal(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitList(t){const{type:e,offset:i=0,child:n}=t,r=R(t.nullBitmap),s=E(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,o,a,[s,void 0,r],[n])}visitStruct(t){const{type:e,offset:i=0,children:n=[]}=t,r=R(t.nullBitmap),{length:s=n.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,void 0,r],n)}visitUnion(t){const{type:e,offset:i=0,children:n=[]}=t,r=R(t.nullBitmap),s=C(e.ArrayType,t.typeIds),{length:o=s.length,nullCount:a=(t.nullBitmap?-1:0)}=t;if(jt.isSparseUnion(e))return new Oi(e,i,o,a,[void 0,void 0,r,s],n);const c=E(t.valueOffsets);return new Oi(e,i,o,a,[c,void 0,r,s],n)}visitDictionary(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.indices.ArrayType,t.data),{dictionary:s=new nn([(new xi).visit({type:e.dictionary})])}=t,{length:o=r.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,o,a,[void 0,r,n],[],s)}visitInterval(t){const{type:e,offset:i=0}=t,n=R(t.nullBitmap),r=C(e.ArrayType,t.data),{length:s=r.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,r,n])}visitFixedSizeList(t){const{type:e,offset:i=0,child:n=(new xi).visit({type:e.valueType})}=t,r=R(t.nullBitmap),{length:s=n.length/le(e),nullCount:o=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,s,o,[void 0,void 0,r],[n])}visitMap(t){const{type:e,offset:i=0,child:n=(new xi).visit({type:e.childType})}=t,r=R(t.nullBitmap),s=E(t.valueOffsets),{length:o=s.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Oi(e,i,o,a,[s,void 0,r],[n])}}function Mi(t){return(new xi).visit(t)}class Fi{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function Ni(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function Li(t){return t.reduce(((t,e,i)=>(t[i+1]=t[i]+e.length,t)),new Uint32Array(t.length+1))}function Ui(t,e,i,n){const r=[];for(let s=-1,o=t.length;++s<o;){const o=t[s],a=e[s],{length:c}=o;if(a>=n)break;if(i>=a+c)continue;if(a>=i&&a+c<=n){r.push(o);continue}const l=Math.max(0,i-a),u=Math.min(n-a,c);r.push(o.slice(l,u-l))}return 0===r.length&&r.push(t[0].slice(0,0)),r}function Ci(t,e,i,n){let r=0,s=0,o=e.length-1;do{if(r>=o-1)return i<e[o]?n(t,r,i-e[r]):null;s=r+Math.trunc(.5*(o-r)),i<e[s]?o=s:r=s}while(r<o)}function Ei(t,e){return t.getValid(e)}function Ri(t){function e(e,i,n){return t(e[i],n)}return function(t){return Ci(this.data,this._offsets,t,e)}}function Vi(t){let e;function i(i,n,r){return t(i[n],r,e)}return function(t,n){const r=this.data;e=n;const s=Ci(r,this._offsets,t,i);return e=void 0,s}}function zi(t){let e;function i(i,n,r){let s=r,o=0,a=0;for(let c=n-1,l=i.length;++c<l;){const n=i[c];if(~(o=t(n,e,s)))return a+o;s=0,a+=n.length}return-1}return function(t,n){e=t;const r=this.data,s="number"!=typeof n?i(r,0,0):Ci(r,this._offsets,n,i);return e=void 0,s}}class Pi extends ue{}function ji(t,e,i){if(void 0===e)return-1;if(null===e)return function(t,e){const{nullBitmap:i}=t;if(!i||t.nullCount<=0)return-1;let n=0;for(const r of new Ai(i,t.offset+(e||0),t.length,i,Ii)){if(!r)return n;++n}return-1}(t,i);const n=ui.getVisitFn(t),r=gi(e);for(let s=(i||0)-1,o=t.length;++s<o;)if(r(n(t,s)))return s;return-1}function ki(t,e,i){const n=ui.getVisitFn(t),r=gi(e);for(let s=(i||0)-1,o=t.length;++s<o;)if(r(n(t,s)))return s;return-1}Pi.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},Pi.prototype.visitBool=ji,Pi.prototype.visitInt=ji,Pi.prototype.visitInt8=ji,Pi.prototype.visitInt16=ji,Pi.prototype.visitInt32=ji,Pi.prototype.visitInt64=ji,Pi.prototype.visitUint8=ji,Pi.prototype.visitUint16=ji,Pi.prototype.visitUint32=ji,Pi.prototype.visitUint64=ji,Pi.prototype.visitFloat=ji,Pi.prototype.visitFloat16=ji,Pi.prototype.visitFloat32=ji,Pi.prototype.visitFloat64=ji,Pi.prototype.visitUtf8=ji,Pi.prototype.visitBinary=ji,Pi.prototype.visitFixedSizeBinary=ji,Pi.prototype.visitDate=ji,Pi.prototype.visitDateDay=ji,Pi.prototype.visitDateMillisecond=ji,Pi.prototype.visitTimestamp=ji,Pi.prototype.visitTimestampSecond=ji,Pi.prototype.visitTimestampMillisecond=ji,Pi.prototype.visitTimestampMicrosecond=ji,Pi.prototype.visitTimestampNanosecond=ji,Pi.prototype.visitTime=ji,Pi.prototype.visitTimeSecond=ji,Pi.prototype.visitTimeMillisecond=ji,Pi.prototype.visitTimeMicrosecond=ji,Pi.prototype.visitTimeNanosecond=ji,Pi.prototype.visitDecimal=ji,Pi.prototype.visitList=ji,Pi.prototype.visitStruct=ji,Pi.prototype.visitUnion=ji,Pi.prototype.visitDenseUnion=ki,Pi.prototype.visitSparseUnion=ki,Pi.prototype.visitDictionary=ji,Pi.prototype.visitInterval=ji,Pi.prototype.visitIntervalDayTime=ji,Pi.prototype.visitIntervalYearMonth=ji,Pi.prototype.visitFixedSizeList=ji,Pi.prototype.visitMap=ji;const $i=new Pi;class Wi extends ue{}function Yi(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===ot.Timestamp||e instanceof $t&&64!==e.bitWidth||e instanceof qt&&64!==e.bitWidth||e instanceof Yt&&e.precision!==Z.HALF))return new Fi(t.data.length,(e=>{const i=t.data[e];return i.values.subarray(0,i.length)[Symbol.iterator]()}));let i=0;return new Fi(t.data.length,(e=>{const n=t.data[e].length,r=t.slice(i,i+n);return i+=n,new Hi(r)}))}class Hi{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Wi.prototype.visitNull=Yi,Wi.prototype.visitBool=Yi,Wi.prototype.visitInt=Yi,Wi.prototype.visitInt8=Yi,Wi.prototype.visitInt16=Yi,Wi.prototype.visitInt32=Yi,Wi.prototype.visitInt64=Yi,Wi.prototype.visitUint8=Yi,Wi.prototype.visitUint16=Yi,Wi.prototype.visitUint32=Yi,Wi.prototype.visitUint64=Yi,Wi.prototype.visitFloat=Yi,Wi.prototype.visitFloat16=Yi,Wi.prototype.visitFloat32=Yi,Wi.prototype.visitFloat64=Yi,Wi.prototype.visitUtf8=Yi,Wi.prototype.visitBinary=Yi,Wi.prototype.visitFixedSizeBinary=Yi,Wi.prototype.visitDate=Yi,Wi.prototype.visitDateDay=Yi,Wi.prototype.visitDateMillisecond=Yi,Wi.prototype.visitTimestamp=Yi,Wi.prototype.visitTimestampSecond=Yi,Wi.prototype.visitTimestampMillisecond=Yi,Wi.prototype.visitTimestampMicrosecond=Yi,Wi.prototype.visitTimestampNanosecond=Yi,Wi.prototype.visitTime=Yi,Wi.prototype.visitTimeSecond=Yi,Wi.prototype.visitTimeMillisecond=Yi,Wi.prototype.visitTimeMicrosecond=Yi,Wi.prototype.visitTimeNanosecond=Yi,Wi.prototype.visitDecimal=Yi,Wi.prototype.visitList=Yi,Wi.prototype.visitStruct=Yi,Wi.prototype.visitUnion=Yi,Wi.prototype.visitDenseUnion=Yi,Wi.prototype.visitSparseUnion=Yi,Wi.prototype.visitDictionary=Yi,Wi.prototype.visitInterval=Yi,Wi.prototype.visitIntervalDayTime=Yi,Wi.prototype.visitIntervalYearMonth=Yi,Wi.prototype.visitFixedSizeList=Yi,Wi.prototype.visitMap=Yi;const Ki=new Wi,Ji=(t,e)=>t+e;class Gi extends ue{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return 16}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===tt.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitStruct(t,e){return this.visitMany(t.children,t.children.map((()=>e))).reduce(Ji,0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return this.visitMany(t.children,t.children.map((()=>e))).reduce(Ji,0)}visitDictionary(t,e){var i;return t.type.indices.bitWidth/8+((null===(i=t.dictionary)||void 0===i?void 0:i.getByteLength(t.values[e]))||0)}}const Zi=({type:t,children:e,typeIds:i,valueOffsets:n},r)=>{const s=t.typeIdToChildIndex[i[r]];return 8+Qi.visit(e[s],n[r])},qi=({children:t},e)=>4+Qi.visitMany(t,t.map((()=>e))).reduce(Ji,0);Gi.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Gi.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,Gi.prototype.visitList=({valueOffsets:t,stride:e,children:i},n)=>{const r=i[0],{[n*e]:s}=t,{[n*e+1]:o}=t,a=Qi.getVisitFn(r.type),c=r.slice(s,o-s);let l=8;for(let u=-1,d=o-s;++u<d;)l+=a(c,u);return l},Gi.prototype.visitFixedSizeList=({stride:t,children:e},i)=>{const n=e[0],r=n.slice(i*t,t),s=Qi.getVisitFn(n.type);let o=0;for(let a=-1,c=r.length;++a<c;)o+=s(r,a);return o},Gi.prototype.visitUnion=(t,e)=>t.type.mode===J.Dense?Zi(t,e):qi(t,e),Gi.prototype.visitDenseUnion=Zi,Gi.prototype.visitSparseUnion=qi;const Qi=new Gi;var Xi;const tn={},en={};class nn{constructor(t){var e,i,n;const r=t[0]instanceof nn?t.flatMap((t=>t.data)):t;if(r.some((t=>!(t instanceof Oi))))throw new TypeError("Vector constructor expects an Array of Data instances.");const s=null===(e=r[0])||void 0===e?void 0:e.type;switch(r.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:i,byteLength:n}=tn[s.typeId],o=r[0];this.isValid=t=>Ei(o,t),this.get=e=>t(o,e),this.set=(t,i)=>e(o,t,i),this.indexOf=t=>i(o,t),this.getByteLength=t=>n(o,t),this._offsets=[0,o.length];break}default:Object.setPrototypeOf(this,en[s.typeId]),this._offsets=Li(r)}this.data=r,this.type=s,this.stride=le(s),this.numChildren=null!==(n=null===(i=s.children)||void 0===i?void 0:i.length)&&void 0!==n?n:0,this.length=this._offsets[this._offsets.length-1]}get byteLength(){return-1===this._byteLength&&(this._byteLength=this.data.reduce(((t,e)=>t+e.byteLength),0)),this._byteLength}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ni(this.data)),this._nullCount}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${ot[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>0}getByteLength(t){return 0}[Symbol.iterator](){return Ki.visit(this)}concat(...t){return new nn(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new nn(mi(this,t,e,(({data:t,_offsets:e},i,n)=>Ui(t,e,i,n))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:i,stride:n,ArrayType:r}=this;switch(t.typeId){case ot.Int:case ot.Float:case ot.Decimal:case ot.Time:case ot.Timestamp:switch(e.length){case 0:return new r;case 1:return e[0].values.subarray(0,i*n);default:return e.reduce(((t,{values:e})=>(t.array.set(e,t.offset),t.offset+=e.length,t)),{array:new r(i*n),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new nn(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!jt.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(jt.isDictionary(this.type)){const t=new rn(this.data[0].dictionary),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new nn(e)}return new rn(this)}unmemoize(){if(jt.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const i=e.clone();return i.dictionary=t,i}));return new nn(e)}return this}}Xi=Symbol.toStringTag,nn[Xi]=(t=>{t.type=jt.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._nullCount=-1,t._byteLength=-1,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(ot).map((t=>ot[t])).filter((t=>"number"==typeof t&&t!==ot.NONE));for(const i of e){const e=ui.getVisitFnByTypeId(i),n=Re.getVisitFnByTypeId(i),r=$i.getVisitFnByTypeId(i),s=Qi.getVisitFnByTypeId(i);tn[i]={get:e,set:n,indexOf:r,byteLength:s},en[i]=Object.create(t,{isValid:{value:Ri(Ei)},get:{value:Ri(ui.getVisitFnByTypeId(i))},set:{value:Vi(Re.getVisitFnByTypeId(i))},indexOf:{value:zi($i.getVisitFnByTypeId(i))},getByteLength:{value:Ri(Qi.getVisitFnByTypeId(i))}})}return"Vector"})(nn.prototype);class rn extends nn{constructor(t){super(t.data);const e=this.get,i=this.set,n=this.slice,r=new Array(this.length);Object.defineProperty(this,"get",{value(t){const i=r[t];if(void 0!==i)return i;const n=e.call(this,t);return r[t]=n,n}}),Object.defineProperty(this,"set",{value(t,e){i.call(this,t,e),r[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new rn(n.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new nn(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class sn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,i,n){return t.prep(8,24),t.writeInt64(n),t.pad(4),t.writeInt32(i),t.writeInt64(e),t.offset()}}class on{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new on).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(e,i){return e.setPosition(e.position()+t),(i||new on).__init(e.readInt32(e.position())+e.position(),e)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,i){return on.startKeyValue(t),on.addKey(t,e),on.addValue(t,i),on.endKeyValue(t)}}var an,cn,ln,un,dn,hn,pn,yn,fn,bn,mn;!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(an||(an={})),(ln=cn||(cn={}))[ln.Little=0]="Little",ln[ln.Big=1]="Big",(dn=un||(un={}))[dn.DenseArray=0]="DenseArray";class vn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new vn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(e,i){return e.setPosition(e.position()+t),(i||new vn).__init(e.readInt32(e.position())+e.position(),e)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,i){return vn.startInt(t),vn.addBitWidth(t,e),vn.addIsSigned(t,i),vn.endInt(t)}}class gn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new gn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(e,i){return e.setPosition(e.position()+t),(i||new gn).__init(e.readInt32(e.position())+e.position(),e)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new vn).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):un.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,un.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}class _n{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new _n).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(e,i){return e.setPosition(e.position()+t),(i||new _n).__init(e.readInt32(e.position())+e.position(),e)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return _n.startBinary(t),_n.endBinary(t)}}class wn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new wn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(e,i){return e.setPosition(e.position()+t),(i||new wn).__init(e.readInt32(e.position())+e.position(),e)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return wn.startBool(t),wn.endBool(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(hn||(hn={}));class In{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new In).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(e,i){return e.setPosition(e.position()+t),(i||new In).__init(e.readInt32(e.position())+e.position(),e)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):hn.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,hn.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return In.startDate(t),In.addUnit(t,e),In.endDate(t)}}class Sn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new Sn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(e,i){return e.setPosition(e.position()+t),(i||new Sn).__init(e.readInt32(e.position())+e.position(),e)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,i,n){return Sn.startDecimal(t),Sn.addPrecision(t,e),Sn.addScale(t,i),Sn.addBitWidth(t,n),Sn.endDecimal(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(pn||(pn={}));class Bn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new Bn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(e,i){return e.setPosition(e.position()+t),(i||new Bn).__init(e.readInt32(e.position())+e.position(),e)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return Bn.startFixedSizeBinary(t),Bn.addByteWidth(t,e),Bn.endFixedSizeBinary(t)}}class An{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new An).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(e,i){return e.setPosition(e.position()+t),(i||new An).__init(e.readInt32(e.position())+e.position(),e)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return An.startFixedSizeList(t),An.addListSize(t,e),An.endFixedSizeList(t)}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(yn||(yn={}));class Tn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new Tn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(e,i){return e.setPosition(e.position()+t),(i||new Tn).__init(e.readInt32(e.position())+e.position(),e)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):yn.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,yn.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return Tn.startFloatingPoint(t),Tn.addPrecision(t,e),Tn.endFloatingPoint(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(fn||(fn={}));class Dn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new Dn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(e,i){return e.setPosition(e.position()+t),(i||new Dn).__init(e.readInt32(e.position())+e.position(),e)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):fn.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,fn.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return Dn.startInterval(t),Dn.addUnit(t,e),Dn.endInterval(t)}}class On{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new On).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(e,i){return e.setPosition(e.position()+t),(i||new On).__init(e.readInt32(e.position())+e.position(),e)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return On.startList(t),On.endList(t)}}class xn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new xn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(e,i){return e.setPosition(e.position()+t),(i||new xn).__init(e.readInt32(e.position())+e.position(),e)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return xn.startMap(t),xn.addKeysSorted(t,e),xn.endMap(t)}}class Mn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new Mn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(e,i){return e.setPosition(e.position()+t),(i||new Mn).__init(e.readInt32(e.position())+e.position(),e)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return Mn.startNull(t),Mn.endNull(t)}}class Fn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new Fn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(e,i){return e.setPosition(e.position()+t),(i||new Fn).__init(e.readInt32(e.position())+e.position(),e)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return Fn.startStruct_(t),Fn.endStruct_(t)}}class Nn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new Nn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(e,i){return e.setPosition(e.position()+t),(i||new Nn).__init(e.readInt32(e.position())+e.position(),e)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):pn.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,pn.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,i){return Nn.startTime(t),Nn.addUnit(t,e),Nn.addBitWidth(t,i),Nn.endTime(t)}}class Ln{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new Ln).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(e,i){return e.setPosition(e.position()+t),(i||new Ln).__init(e.readInt32(e.position())+e.position(),e)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):pn.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,pn.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,i){return Ln.startTimestamp(t),Ln.addUnit(t,e),Ln.addTimezone(t,i),Ln.endTimestamp(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(bn||(bn={}));class Un{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new Un).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(e,i){return e.setPosition(e.position()+t),(i||new Un).__init(e.readInt32(e.position())+e.position(),e)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):bn.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,bn.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addInt32(e[i]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,i){return Un.startUnion(t),Un.addMode(t,e),Un.addTypeIds(t,i),Un.endUnion(t)}}class Cn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new Cn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(e,i){return e.setPosition(e.position()+t),(i||new Cn).__init(e.readInt32(e.position())+e.position(),e)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return Cn.startUtf8(t),Cn.endUtf8(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList"}(mn||(mn={}));class En{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new En).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(e,i){return e.setPosition(e.position()+t),(i||new En).__init(e.readInt32(e.position())+e.position(),e)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):mn.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new gn).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const i=this.bb.__offset(this.bb_pos,14);return i?(e||new En).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,16);return i?(e||new on).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,mn.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class Rn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new Rn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(e,i){return e.setPosition(e.position()+t),(i||new Rn).__init(e.readInt32(e.position())+e.position(),e)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):cn.Little}fields(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new En).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new on).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):this.bb.createLong(0,0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,cn.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let i=e.length-1;i>=0;i--)t.addInt64(e[i]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,i,n,r){return Rn.startSchema(t),Rn.addEndianness(t,e),Rn.addFields(t,i),Rn.addCustomMetadata(t,n),Rn.addFeatures(t,r),Rn.endSchema(t)}}class Vn{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new Vn).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(e,i){return e.setPosition(e.position()+t),(i||new Vn).__init(e.readInt32(e.position())+e.position(),e)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):an.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Rn).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new sn).__init(this.bb.__vector(this.bb_pos+i)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const i=this.bb.__offset(this.bb_pos,10);return i?(e||new sn).__init(this.bb.__vector(this.bb_pos+i)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,12);return i?(e||new on).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,an.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}class zn{constructor(t=[],e,i){this.fields=t||[],this.metadata=e||new Map,i||(i=kn(t)),this.dictionaries=i}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),i=this.fields.filter((t=>e.has(t.name)));return new zn(i,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new zn(e,this.metadata)}assign(...t){const e=t[0]instanceof zn?t[0]:Array.isArray(t[0])?new zn(t[0]):new zn(t),i=[...this.fields],n=jn(jn(new Map,this.metadata),e.metadata),r=e.fields.filter((t=>{const e=i.findIndex((e=>e.name===t.name));return!~e||(i[e]=t.clone({metadata:jn(jn(new Map,i[e].metadata),t.metadata)}))&&!1})),s=kn(r,new Map);return new zn([...i,...r],n,new Map([...this.dictionaries,...s]))}}zn.prototype.fields=null,zn.prototype.metadata=null,zn.prototype.dictionaries=null;class Pn{constructor(t,e,i=!1,n){this.name=t,this.type=e,this.nullable=i,this.metadata=n||new Map}static new(...t){let[e,i,n,r]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===i&&(i=t[0].type),void 0===n&&(n=t[0].nullable),void 0===r&&(r=t[0].metadata)),new Pn(`${e}`,i,n,r)}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,i,n,r]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:i=this.type,nullable:n=this.nullable,metadata:r=this.metadata}=t[0]):[e=this.name,i=this.type,n=this.nullable,r=this.metadata]=t,Pn.new(e,i,n,r)}}function jn(t,e){return new Map([...t||new Map,...e||new Map])}function kn(t,e=new Map){for(let i=-1,n=t.length;++i<n;){const n=t[i].type;if(jt.isDictionary(n))if(e.has(n.id)){if(e.get(n.id)!==n.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(n.id,n.dictionary);n.children&&n.children.length>0&&kn(n.children,e)}return e}Pn.prototype.type=null,Pn.prototype.name=null,Pn.prototype.nullable=null,Pn.prototype.metadata=null;var $n=e,Wn=n,Yn=i;class Hn{constructor(t,e=H.V4,i,n){this.schema=t,this.version=e,i&&(this._recordBatches=i),n&&(this._dictionaryBatches=n)}static decode(t){t=new Yn(R(t));const e=Vn.getRootAsFooter(t),i=zn.decode(e.schema());return new Kn(i,e)}static encode(t){const e=new Wn,i=zn.encode(e,t.schema);Vn.startRecordBatchesVector(e,t.numRecordBatches);for(const s of[...t.recordBatches()].slice().reverse())Jn.encode(e,s);const n=e.endVector();Vn.startDictionariesVector(e,t.numDictionaries);for(const s of[...t.dictionaryBatches()].slice().reverse())Jn.encode(e,s);const r=e.endVector();return Vn.startFooter(e),Vn.addSchema(e,i),Vn.addVersion(e,H.V4),Vn.addRecordBatches(e,n),Vn.addDictionaries(e,r),Vn.finishFooterBuffer(e,Vn.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}*recordBatches(){for(let t,e=-1,i=this.numRecordBatches;++e<i;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,i=this.numDictionaries;++e<i;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class Kn extends Hn{constructor(t,e){super(t,e.version()),this._footer=e}get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return Jn.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return Jn.decode(e)}return null}}class Jn{constructor(t,e,i){this.metaDataLength=t,this.offset="number"==typeof i?i:i.low,this.bodyLength="number"==typeof e?e:e.low}static decode(t){return new Jn(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:i}=e,n=new $n(e.offset,0),r=new $n(e.bodyLength,0);return sn.createBlock(t,n,i,r)}}const Gn=Object.freeze({done:!0,value:void 0});class Zn{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class qn{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Qn extends qn{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return r(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(Gn);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return k.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return k.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return r(this,void 0,void 0,(function*(){return yield this.abort(t),Gn}))}return(t){return r(this,void 0,void 0,(function*(){return yield this.close(),Gn}))}read(t){return r(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return r(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(Gn)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Xn extends Qn{write(t){if((t=R(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?d(this.toUint8Array(!0)):this.toUint8Array(!1).then(d)}toUint8Array(t=!1){return t?U(this._values)[0]:(()=>r(this,void 0,void 0,(function*(){var t,e;const i=[];let n=0;try{for(var r,s=l(this);!(r=yield s.next()).done;){const t=r.value;i.push(t),n+=t.byteLength}}catch(o){t={error:o}}finally{try{r&&!r.done&&(e=s.return)&&(yield e.call(s))}finally{if(t)throw t.error}}return U(i,n)[0]})))()}}class tr{constructor(t){t&&(this.source=new ir(k.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class er{constructor(t){t instanceof er?this.source=t.source:t instanceof Xn?this.source=new nr(k.fromAsyncIterable(t)):F(t)?this.source=new nr(k.fromNodeStream(t)):M(t)?this.source=new nr(k.fromDOMStream(t)):O(t)?this.source=new nr(k.fromDOMStream(t.body)):S(t)?this.source=new nr(k.fromIterable(t)):(I(t)||B(t))&&(this.source=new nr(k.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class ir{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||Gn)}return(t){return Object.create(this.source.return&&this.source.return(t)||Gn)}}class nr{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return r(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return r(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return r(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return r(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return r(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||Gn;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return r(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||Gn;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class rr extends tr{constructor(t,e){super(),this.position=0,this.buffer=R(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:i}=this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:i,position:n}=this;return e&&n<i?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(i,n+Math.min(i-n,t)),e.subarray(n,this.position)):null}readAt(t,e){const i=this.buffer,n=Math.min(this.size,t+e);return i?i.subarray(t,n):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class sr extends er{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>r(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return r(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:i}=yield this.readAt(t,4);return new DataView(e,i).getInt32(0,!0)}))}seek(t){return r(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return r(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:i,position:n}=this;if(e&&n<i){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let r=n,s=0,o=0;const a=Math.min(i,r+Math.min(i-r,t)),c=new Uint8Array(Math.max(0,(this.position=a)-r));for(;(r+=o)<a&&(s+=o)<c.byteLength;)({bytesRead:o}=yield e.read(c,s,c.byteLength-s,r));return c}return null}))}readAt(t,e){return r(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:i,size:n}=this;if(i&&t+e<n){const r=Math.min(n,t+e),s=new Uint8Array(r-t);return(yield i.read(s,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return r(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return r(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return r(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function or(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const ar=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class cr{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),i=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let n=e[3]*i[3];this.buffer[0]=65535&n;let r=n>>>16;return n=e[2]*i[3],r+=n,n=e[3]*i[2]>>>0,r+=n,this.buffer[0]+=r<<16,this.buffer[1]=r>>>0<n?65536:0,this.buffer[1]+=r>>>16,this.buffer[1]+=e[1]*i[3]+e[2]*i[2]+e[3]*i[1],this.buffer[1]+=e[0]*i[3]+e[1]*i[2]+e[2]*i[1]+e[3]*i[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${or(this.buffer[1])} ${or(this.buffer[0])}`}}class lr extends cr{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return lr.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return lr.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const i=t.length,n=new lr(e);for(let r=0;r<i;){const e=8<i-r?8:i-r,s=new lr(new Uint32Array([Number.parseInt(t.slice(r,r+e),10),0])),o=new lr(new Uint32Array([ar[e],0]));n.times(o),n.plus(s),r+=e}return n}static convertArray(t){const e=new Uint32Array(2*t.length);for(let i=-1,n=t.length;++i<n;)lr.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new lr(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new lr(new Uint32Array(t.buffer)).plus(e)}}class ur extends cr{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=this.buffer[1]<<0,i=t.buffer[1]<<0;return e<i||e===i&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return ur.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return ur.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const i=t.startsWith("-"),n=t.length,r=new ur(e);for(let s=i?1:0;s<n;){const e=8<n-s?8:n-s,i=new ur(new Uint32Array([Number.parseInt(t.slice(s,s+e),10),0])),o=new ur(new Uint32Array([ar[e],0]));r.times(o),r.plus(i),s+=e}return i?r.negate():r}static convertArray(t){const e=new Uint32Array(2*t.length);for(let i=-1,n=t.length;++i<n;)ur.from(t[i],new Uint32Array(e.buffer,e.byteOffset+2*i*4,2));return e}static multiply(t,e){return new ur(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new ur(new Uint32Array(t.buffer)).plus(e)}}class dr{constructor(t){this.buffer=t}high(){return new ur(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new ur(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new lr(new Uint32Array([this.buffer[3],0])),i=new lr(new Uint32Array([this.buffer[2],0])),n=new lr(new Uint32Array([this.buffer[1],0])),r=new lr(new Uint32Array([this.buffer[0],0])),s=new lr(new Uint32Array([t.buffer[3],0])),o=new lr(new Uint32Array([t.buffer[2],0])),a=new lr(new Uint32Array([t.buffer[1],0])),c=new lr(new Uint32Array([t.buffer[0],0]));let l=lr.multiply(r,c);this.buffer[0]=l.low();const u=new lr(new Uint32Array([l.high(),0]));l=lr.multiply(n,c),u.plus(l),l=lr.multiply(r,a),u.plus(l),this.buffer[1]=u.low(),this.buffer[3]=u.lessThan(l)?1:0,this.buffer[2]=u.high();return new lr(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(lr.multiply(i,c)).plus(lr.multiply(n,a)).plus(lr.multiply(r,o)),this.buffer[3]+=lr.multiply(e,c).plus(lr.multiply(i,a)).plus(lr.multiply(n,o)).plus(lr.multiply(r,s)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${or(this.buffer[3])} ${or(this.buffer[2])} ${or(this.buffer[1])} ${or(this.buffer[0])}`}static multiply(t,e){return new dr(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new dr(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return dr.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return dr.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const i=t.startsWith("-"),n=t.length,r=new dr(e);for(let s=i?1:0;s<n;){const e=8<n-s?8:n-s,i=new dr(new Uint32Array([Number.parseInt(t.slice(s,s+e),10),0,0,0])),o=new dr(new Uint32Array([ar[e],0,0,0]));r.times(o),r.plus(i),s+=e}return i?r.negate():r}static convertArray(t){const e=new Uint32Array(4*t.length);for(let i=-1,n=t.length;++i<n;)dr.from(t[i],new Uint32Array(e.buffer,e.byteOffset+16*i,4));return e}}class hr extends ue{constructor(t,e,i,n){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=i,this.dictionaries=n}visit(t){return super.visit(t instanceof Pn?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return Mi({type:t,length:e})}visitBool(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitInt(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDate(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitTime(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitList(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),children:this.visitMany(t.children)})}visitUnion(t){return t.mode===J.Sparse?this.visitSparseUnion(t):this.visitDenseUnion(t)}visitDenseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:i}=this.nextFieldNode()){return Mi({type:t,length:e,nullCount:i,nullBitmap:this.readNullBitmap(t,i),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,i=this.nextBufferRange()){return e>0&&this.readData(t,i)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:i}=this.nextBufferRange()){return this.bytes.subarray(i,i+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class pr extends hr{constructor(t,e,i,n){super(new Uint8Array(0),e,i,n),this.sources=t}readNullBitmap(t,e,{offset:i}=this.nextBufferRange()){return e<=0?new Uint8Array(0):Bi(this.sources[i])}readOffsets(t,{offset:e}=this.nextBufferRange()){return C(Uint8Array,C(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return C(Uint8Array,C(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:i}=this;return jt.isTimestamp(t)||(jt.isInt(t)||jt.isTime(t))&&64===t.bitWidth||jt.isDate(t)&&t.unit===Q.MILLISECOND?C(Uint8Array,ur.convertArray(i[e])):jt.isDecimal(t)?C(Uint8Array,dr.convertArray(i[e])):jt.isBinary(t)||jt.isFixedSizeBinary(t)?function(t){const e=t.join(""),i=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)i[n>>1]=Number.parseInt(e.slice(n,n+2),16);return i}(i[e]):jt.isBool(t)?Bi(i[e]):jt.isUtf8(t)?p(i[e].join("")):C(Uint8Array,C(t.ArrayType,i[e].map((t=>+t))))}}class yr extends ue{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,i)=>this.compareFields(t,e[i])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function fr(t,e){return e instanceof t.constructor}function br(t,e){return t===e||fr(t,e)}function mr(t,e){return t===e||fr(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function vr(t,e){return t===e||fr(t,e)&&t.precision===e.precision}function gr(t,e){return t===e||fr(t,e)&&t.unit===e.unit}function _r(t,e){return t===e||fr(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function wr(t,e){return t===e||fr(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function Ir(t,e){return t===e||fr(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,i)=>t===e.typeIds[i]))&&Br.compareManyFields(t.children,e.children)}function Sr(t,e){return t===e||fr(t,e)&&t.unit===e.unit}yr.prototype.visitNull=br,yr.prototype.visitBool=br,yr.prototype.visitInt=mr,yr.prototype.visitInt8=mr,yr.prototype.visitInt16=mr,yr.prototype.visitInt32=mr,yr.prototype.visitInt64=mr,yr.prototype.visitUint8=mr,yr.prototype.visitUint16=mr,yr.prototype.visitUint32=mr,yr.prototype.visitUint64=mr,yr.prototype.visitFloat=vr,yr.prototype.visitFloat16=vr,yr.prototype.visitFloat32=vr,yr.prototype.visitFloat64=vr,yr.prototype.visitUtf8=br,yr.prototype.visitBinary=br,yr.prototype.visitFixedSizeBinary=function(t,e){return t===e||fr(t,e)&&t.byteWidth===e.byteWidth},yr.prototype.visitDate=gr,yr.prototype.visitDateDay=gr,yr.prototype.visitDateMillisecond=gr,yr.prototype.visitTimestamp=_r,yr.prototype.visitTimestampSecond=_r,yr.prototype.visitTimestampMillisecond=_r,yr.prototype.visitTimestampMicrosecond=_r,yr.prototype.visitTimestampNanosecond=_r,yr.prototype.visitTime=wr,yr.prototype.visitTimeSecond=wr,yr.prototype.visitTimeMillisecond=wr,yr.prototype.visitTimeMicrosecond=wr,yr.prototype.visitTimeNanosecond=wr,yr.prototype.visitDecimal=br,yr.prototype.visitList=function(t,e){return t===e||fr(t,e)&&t.children.length===e.children.length&&Br.compareManyFields(t.children,e.children)},yr.prototype.visitStruct=function(t,e){return t===e||fr(t,e)&&t.children.length===e.children.length&&Br.compareManyFields(t.children,e.children)},yr.prototype.visitUnion=Ir,yr.prototype.visitDenseUnion=Ir,yr.prototype.visitSparseUnion=Ir,yr.prototype.visitDictionary=function(t,e){return t===e||fr(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Br.visit(t.indices,e.indices)&&Br.visit(t.dictionary,e.dictionary)},yr.prototype.visitInterval=Sr,yr.prototype.visitIntervalDayTime=Sr,yr.prototype.visitIntervalYearMonth=Sr,yr.prototype.visitFixedSizeList=function(t,e){return t===e||fr(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Br.compareManyFields(t.children,e.children)},yr.prototype.visitMap=function(t,e){return t===e||fr(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Br.compareManyFields(t.children,e.children)};const Br=new yr;function Ar(t,e){return Br.compareSchemas(t,e)}function Tr(t,e){return function(t,e){const i=[...t.fields],n=[],r={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let s=0,o=0,a=-1;const c=e.length;let l,u=[];for(;r.numBatches-- >0;){for(o=Number.POSITIVE_INFINITY,a=-1;++a<c;)u[a]=l=e[a].shift(),o=Math.min(o,l?l.length:o);Number.isFinite(o)&&(u=Dr(i,o,u,e,r),o>0&&(n[s++]=Mi({type:new ee(i),length:o,nullCount:0,children:u.slice()})))}return[t=t.assign(i),n.map((e=>new Er(t,e)))]}(t,e.map((t=>t.data.concat())))}function Dr(t,e,i,n,r){var s;const o=(e+63&-64)>>3;for(let a=-1,c=n.length;++a<c;){const c=i[a],l=null==c?void 0:c.length;if(l>=e)l===e?i[a]=c:(i[a]=c.slice(0,e),r.numBatches=Math.max(r.numBatches,n[a].unshift(c.slice(e,l-e))));else{const n=t[a];t[a]=n.clone({nullable:!0}),i[a]=null!==(s=null==c?void 0:c._changeLengthAndBackfillNullBitmap(e))&&void 0!==s?s:Mi({type:n.type,length:e,nullCount:e,nullBitmap:new Uint8Array(o)})}}return i}var Or,xr,Mr,Fr,Nr,Lr,Ur;class Cr{constructor(...t){var e,i;if(0===t.length)return this.batches=[],this.schema=new zn([]),this._offsets=[0],this;let n,r;t[0]instanceof zn&&(n=t.shift()),t[t.length-1]instanceof Uint32Array&&(r=t.pop());const s=t=>{if(t){if(t instanceof Er)return[t];if(t instanceof Cr)return t.batches;if(t instanceof Oi){if(t.type instanceof ee)return[new Er(new zn(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>s(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>s(t)));if("object"==typeof t){const e=Object.keys(t),i=e.map((e=>new nn([t[e]]))),n=new zn(e.map(((t,e)=>new Pn(String(t),i[e].type)))),[,r]=Tr(n,i);return 0===r.length?[new Er(t)]:r}}}return[]},o=t.flatMap((t=>s(t)));if(n=null!==(i=null!=n?n:null===(e=o[0])||void 0===e?void 0:e.schema)&&void 0!==i?i:new zn([]),!(n instanceof zn))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const a of o){if(!(a instanceof Er))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!Ar(n,a.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=n,this.batches=o,this._offsets=null!=r?r:Li(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=Ni(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return Ki.visit(new nn(this.data))}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,i=this.data.concat(t.flatMap((({data:t})=>t)));return new Cr(e,i.map((t=>new Er(e,t))))}slice(t,e){const i=this.schema;[t,e]=mi({length:this.numRows},t,e);const n=Ui(this.data,this._offsets,t,e);return new Cr(i,n.map((t=>new Er(i,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:i}=this.schema.fields[t],n=Mi({type:i,length:0,nullCount:0});e.push(n._changeLengthAndBackfillNullBitmap(this.numRows))}return new nn(e)}return null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new nn([Mi({type:new kt,length:this.numRows})]));const r=i.fields.slice(),s=r[t].clone({type:e.type}),o=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[r[t],o[t]]=[s,e],[i,n]=Tr(i,o)}return new Cr(i,n)}select(t){const e=this.schema.fields.reduce(((t,e,i)=>t.set(e.name,i)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),i=this.batches.map((e=>e.selectAt(t)));return new Cr(e,i)}assign(t){const e=this.schema.fields,[i,n]=t.schema.fields.reduce(((t,i,n)=>{const[r,s]=t,o=e.findIndex((t=>t.name===i.name));return~o?s[o]=n:r.push(n),t}),[[],[]]),r=this.schema.assign(t.schema),s=[...e.map(((t,e)=>[e,n[e]])).map((([e,i])=>void 0===i?this.getChildAt(e):t.getChildAt(i))),...i.map((e=>t.getChildAt(e)))].filter(Boolean);return new Cr(...Tr(r,s))}}Or=Symbol.toStringTag,Cr[Or]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=Ri(Ei),t.get=Ri(ui.getVisitFn(ot.Struct)),t.set=Vi(Re.getVisitFn(ot.Struct)),t.indexOf=zi($i.getVisitFn(ot.Struct)),t.getByteLength=Ri(Qi.getVisitFn(ot.Struct)),"Table"))(Cr.prototype);class Er{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof zn))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Mi({nullCount:0,type:new ee(this.schema.fields),children:this.schema.fields.map((t=>Mi({type:t.type,nullCount:0})))})]=t,!(this.data instanceof Oi))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=Rr(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:i,children:n,length:r}=Object.keys(e).reduce(((t,i,n)=>(t.children[n]=e[i],t.length=Math.max(t.length,e[i].length),t.fields[n]=Pn.new({name:i,type:e[i].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),s=new zn(i),o=Mi({type:new ee(i),length:r,children:n,nullCount:0});[this.schema,this.data]=Rr(s,o.children,r);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Vr(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return ui.visit(this.data,t)}set(t,e){return Re.visit(this.data,t,e)}indexOf(t,e){return $i.visit(this.data,t,e)}getByteLength(t){return Qi.visit(this.data,t)}[Symbol.iterator](){return Ki.visit(new nn([this.data]))}toArray(){return[...this]}concat(...t){return new Cr(this.schema,[this,...t])}slice(t,e){const[i]=new nn([this.data]).slice(t,e).data;return new Er(this.schema,i)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new nn([this.data.children[t]]):null}setChild(t,e){var i;return this.setChildAt(null===(i=this.schema.fields)||void 0===i?void 0:i.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let i=this.schema,n=this.data;if(t>-1&&t<this.numCols){e||(e=new nn([Mi({type:new kt,length:this.numRows})]));const r=i.fields.slice(),s=n.children.slice(),o=r[t].clone({type:e.type});[r[t],s[t]]=[o,e.data[0]],i=new zn(r,new Map(this.schema.metadata)),n=Mi({type:new ee(r),children:s})}return new Er(i,n)}select(t){const e=this.schema.select(t),i=new ee(e.fields),n=[];for(const r of t){const t=this.schema.fields.findIndex((t=>t.name===r));~t&&(n[t]=this.data.children[t])}return new Er(e,Mi({type:i,length:this.numRows,children:n}))}selectAt(t){const e=this.schema.selectAt(t),i=t.map((t=>this.data.children[t])).filter(Boolean),n=Mi({type:new ee(e.fields),length:this.numRows,children:i});return new Er(e,n)}}function Rr(t,e,i=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var n;const r=[...t.fields],s=[...e],o=(i+63&-64)>>3;for(const[a,c]of t.fields.entries()){const t=e[a];t&&t.length===i||(r[a]=c.clone({nullable:!0}),s[a]=null!==(n=null==t?void 0:t._changeLengthAndBackfillNullBitmap(i))&&void 0!==n?n:Mi({type:c.type,length:i,nullCount:i,nullBitmap:new Uint8Array(o)}))}return[t.assign(r),Mi({type:new ee(r),length:i,children:s})]}function Vr(t,e,i=new Map){for(let n=-1,r=t.length;++n<r;){const r=t[n].type,s=e[n];if(jt.isDictionary(r))if(i.has(r.id)){if(i.get(r.id)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else s.dictionary&&i.set(r.id,s.dictionary);r.children&&r.children.length>0&&Vr(r.children,s.children,i)}return i}xr=Symbol.toStringTag,Er[xr]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Er.prototype);class zr extends Er{constructor(t){const e=t.fields.map((t=>Mi({type:t.type})));super(t,Mi({type:new ee(t.fields),nullCount:0,children:e}))}}(Fr=Mr||(Mr={}))[Fr.BUFFER=0]="BUFFER",(Lr=Nr||(Nr={}))[Lr.LZ4_FRAME=0]="LZ4_FRAME",Lr[Lr.ZSTD=1]="ZSTD";class Pr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new Pr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(e,i){return e.setPosition(e.position()+t),(i||new Pr).__init(e.readInt32(e.position())+e.position(),e)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Nr.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Mr.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Nr.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Mr.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,i){return Pr.startBodyCompression(t),Pr.addCodec(t,e),Pr.addMethod(t,i),Pr.endBodyCompression(t)}}class jr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}}class kr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,i){return t.prep(8,16),t.writeInt64(i),t.writeInt64(e),t.offset()}}class $r{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new $r).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(e,i){return e.setPosition(e.position()+t),(i||new $r).__init(e.readInt32(e.position())+e.position(),e)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}nodes(t,e){const i=this.bb.__offset(this.bb_pos,6);return i?(e||new kr).__init(this.bb.__vector(this.bb_pos+i)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const i=this.bb.__offset(this.bb_pos,8);return i?(e||new jr).__init(this.bb.__vector(this.bb_pos+i)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new Pr).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class Wr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new Wr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(e,i){return e.setPosition(e.position()+t),(i||new Wr).__init(e.readInt32(e.position())+e.position(),e)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new $r).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,t.createLong(0,0))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(Ur||(Ur={}));class Yr{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new Yr).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(e,i){return e.setPosition(e.position()+t),(i||new Yr).__init(e.readInt32(e.position())+e.position(),e)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):an.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Ur.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):this.bb.createLong(0,0)}customMetadata(t,e){const i=this.bb.__offset(this.bb_pos,12);return i?(e||new on).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+i)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,an.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Ur.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,t.createLong(0,0))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let i=e.length-1;i>=0;i--)t.addOffset(e[i]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,i,n,r,s){return Yr.startMessage(t),Yr.addVersion(t,e),Yr.addHeaderType(t,i),Yr.addHeader(t,n),Yr.addBodyLength(t,r),Yr.addCustomMetadata(t,s),Yr.endMessage(t)}}var Hr=e;const Kr=new class extends ue{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return Mn.startNull(e),Mn.endNull(e)}visitInt(t,e){return vn.startInt(e),vn.addBitWidth(e,t.bitWidth),vn.addIsSigned(e,t.isSigned),vn.endInt(e)}visitFloat(t,e){return Tn.startFloatingPoint(e),Tn.addPrecision(e,t.precision),Tn.endFloatingPoint(e)}visitBinary(t,e){return _n.startBinary(e),_n.endBinary(e)}visitBool(t,e){return wn.startBool(e),wn.endBool(e)}visitUtf8(t,e){return Cn.startUtf8(e),Cn.endUtf8(e)}visitDecimal(t,e){return Sn.startDecimal(e),Sn.addScale(e,t.scale),Sn.addPrecision(e,t.precision),Sn.addBitWidth(e,t.bitWidth),Sn.endDecimal(e)}visitDate(t,e){return In.startDate(e),In.addUnit(e,t.unit),In.endDate(e)}visitTime(t,e){return Nn.startTime(e),Nn.addUnit(e,t.unit),Nn.addBitWidth(e,t.bitWidth),Nn.endTime(e)}visitTimestamp(t,e){const i=t.timezone&&e.createString(t.timezone)||void 0;return Ln.startTimestamp(e),Ln.addUnit(e,t.unit),void 0!==i&&Ln.addTimezone(e,i),Ln.endTimestamp(e)}visitInterval(t,e){return Dn.startInterval(e),Dn.addUnit(e,t.unit),Dn.endInterval(e)}visitList(t,e){return On.startList(e),On.endList(e)}visitStruct(t,e){return Fn.startStruct_(e),Fn.endStruct_(e)}visitUnion(t,e){Un.startTypeIdsVector(e,t.typeIds.length);const i=Un.createTypeIdsVector(e,t.typeIds);return Un.startUnion(e),Un.addMode(e,t.mode),Un.addTypeIds(e,i),Un.endUnion(e)}visitDictionary(t,e){const i=this.visit(t.indices,e);return gn.startDictionaryEncoding(e),gn.addId(e,new Hr(t.id,0)),gn.addIsOrdered(e,t.isOrdered),void 0!==i&&gn.addIndexType(e,i),gn.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return Bn.startFixedSizeBinary(e),Bn.addByteWidth(e,t.byteWidth),Bn.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return An.startFixedSizeList(e),An.addListSize(e,t.listSize),An.endFixedSizeList(e)}visitMap(t,e){return xn.startMap(e),xn.addKeysSorted(e,t.keysSorted),xn.endMap(e)}};function Jr(t){return new ss(t.count,Zr(t.columns),qr(t.columns))}function Gr(t,e){return(t.children||[]).filter(Boolean).map((t=>Pn.fromJSON(t,e)))}function Zr(t){return(t||[]).reduce(((t,e)=>{return[...t,new cs(e.count,(i=e.VALIDITY,(i||[]).reduce(((t,e)=>t+ +(0===e)),0))),...Zr(e.children)];var i}),[])}function qr(t,e=[]){for(let i=-1,n=(t||[]).length;++i<n;){const n=t[i];n.VALIDITY&&e.push(new as(e.length,n.VALIDITY.length)),n.TYPE&&e.push(new as(e.length,n.TYPE.length)),n.OFFSET&&e.push(new as(e.length,n.OFFSET.length)),n.DATA&&e.push(new as(e.length,n.DATA.length)),e=qr(n.children,e)}return e}function Qr(t){return new Map(Object.entries(t||{}))}function Xr(t){return new $t(t.isSigned,t.bitWidth)}function ts(t,e){const i=t.type.name;switch(i){case"NONE":case"null":return new kt;case"binary":return new Ht;case"utf8":return new Kt;case"bool":return new Jt;case"list":return new te((e||[])[0]);case"struct":case"struct_":return new ee(e||[])}switch(i){case"int":{const e=t.type;return new $t(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new Yt(Z[e.precision])}case"decimal":{const e=t.type;return new Gt(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new Zt(Q[e.unit])}case"time":{const e=t.type;return new qt(tt[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Qt(tt[e.unit],e.timezone)}case"interval":{const e=t.type;return new Xt(it[e.unit])}case"union":{const i=t.type;return new ie(J[i.mode],i.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new ne(e.byteWidth)}case"fixedsizelist":{const i=t.type;return new re(i.listSize,(e||[])[0])}case"map":{const i=t.type;return new se((e||[])[0],i.keysSorted)}}throw new Error(`Unrecognized type: "${i}"`)}var es=e,is=n,ns=i;class rs{constructor(t,e,i,n){this._version=e,this._headerType=i,this.body=new Uint8Array(0),n&&(this._createHeader=()=>n),this._bodyLength="number"==typeof t?t:t.low}static fromJSON(t,e){const i=new rs(0,H.V4,e);return i._createHeader=function(t,e){return()=>{switch(e){case rt.Schema:return zn.fromJSON(t);case rt.RecordBatch:return ss.fromJSON(t);case rt.DictionaryBatch:return os.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${rt[e]}, type: ${e} }`)}}(t,e),i}static decode(t){t=new ns(R(t));const e=Yr.getRootAsMessage(t),i=e.bodyLength(),n=e.version(),r=e.headerType(),s=new rs(i,n,r);return s._createHeader=function(t,e){return()=>{switch(e){case rt.Schema:return zn.decode(t.header(new Rn));case rt.RecordBatch:return ss.decode(t.header(new $r),t.version());case rt.DictionaryBatch:return os.decode(t.header(new Wr),t.version())}throw new Error(`Unrecognized Message type: { name: ${rt[e]}, type: ${e} }`)}}(e,r),s}static encode(t){const e=new is;let i=-1;return t.isSchema()?i=zn.encode(e,t.header()):t.isRecordBatch()?i=ss.encode(e,t.header()):t.isDictionaryBatch()&&(i=os.encode(e,t.header())),Yr.startMessage(e),Yr.addVersion(e,H.V4),Yr.addHeader(e,i),Yr.addHeaderType(e,t.headerType),Yr.addBodyLength(e,new es(t.bodyLength,0)),Yr.finishMessageBuffer(e,Yr.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof zn)return new rs(0,H.V4,rt.Schema,t);if(t instanceof ss)return new rs(e,H.V4,rt.RecordBatch,t);if(t instanceof os)return new rs(e,H.V4,rt.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===rt.Schema}isRecordBatch(){return this.headerType===rt.RecordBatch}isDictionaryBatch(){return this.headerType===rt.DictionaryBatch}}class ss{constructor(t,e,i){this._nodes=e,this._buffers=i,this._length="number"==typeof t?t:t.low}get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}}class os{constructor(t,e,i=!1){this._data=t,this._isDelta=i,this._id="number"==typeof e?e:e.low}get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}}class as{constructor(t,e){this.offset="number"==typeof t?t:t.low,this.length="number"==typeof e?e:e.low}}class cs{constructor(t,e){this.length="number"==typeof t?t:t.low,this.nullCount="number"==typeof e?e:e.low}}function ls(t,e){const i=[];for(let n,r=-1,s=-1,o=t.childrenLength();++r<o;)(n=t.children(r))&&(i[++s]=Pn.decode(n,e));return i}function us(t){const e=new Map;if(t)for(let i,n,r=-1,s=Math.trunc(t.customMetadataLength());++r<s;)(i=t.customMetadata(r))&&null!=(n=i.key())&&e.set(n,i.value());return e}function ds(t){return new $t(t.isSigned(),t.bitWidth())}function hs(t,e){const i=t.typeType();switch(i){case mn.NONE:case mn.Null:return new kt;case mn.Binary:return new Ht;case mn.Utf8:return new Kt;case mn.Bool:return new Jt;case mn.List:return new te((e||[])[0]);case mn.Struct_:return new ee(e||[])}switch(i){case mn.Int:{const e=t.type(new vn);return new $t(e.isSigned(),e.bitWidth())}case mn.FloatingPoint:{const e=t.type(new Tn);return new Yt(e.precision())}case mn.Decimal:{const e=t.type(new Sn);return new Gt(e.scale(),e.precision(),e.bitWidth())}case mn.Date:{const e=t.type(new In);return new Zt(e.unit())}case mn.Time:{const e=t.type(new Nn);return new qt(e.unit(),e.bitWidth())}case mn.Timestamp:{const e=t.type(new Ln);return new Qt(e.unit(),e.timezone())}case mn.Interval:{const e=t.type(new Dn);return new Xt(e.unit())}case mn.Union:{const i=t.type(new Un);return new ie(i.mode(),i.typeIdsArray()||[],e||[])}case mn.FixedSizeBinary:{const e=t.type(new Bn);return new ne(e.byteWidth())}case mn.FixedSizeList:{const i=t.type(new An);return new re(i.listSize(),(e||[])[0])}case mn.Map:{const i=t.type(new xn);return new se((e||[])[0],i.keysSorted())}}throw new Error(`Unrecognized type: "${mn[i]}" (${i})`)}Pn.encode=function(t,e){let i=-1,n=-1,r=-1;const s=e.type;let o=e.typeId;jt.isDictionary(s)?(o=s.dictionary.typeId,r=Kr.visit(s,t),n=Kr.visit(s.dictionary,t)):n=Kr.visit(s,t);const a=(s.children||[]).map((e=>Pn.encode(t,e))),c=En.createChildrenVector(t,a),l=e.metadata&&e.metadata.size>0?En.createCustomMetadataVector(t,[...e.metadata].map((([e,i])=>{const n=t.createString(`${e}`),r=t.createString(`${i}`);return on.startKeyValue(t),on.addKey(t,n),on.addValue(t,r),on.endKeyValue(t)}))):-1;e.name&&(i=t.createString(e.name));En.startField(t),En.addType(t,n),En.addTypeType(t,o),En.addChildren(t,c),En.addNullable(t,!!e.nullable),-1!==i&&En.addName(t,i);-1!==r&&En.addDictionary(t,r);-1!==l&&En.addCustomMetadata(t,l);return En.endField(t)},Pn.decode=function(t,e){let i,n,r,s,o,a;e&&(a=t.dictionary())?e.has(i=a.id().low)?(s=(s=a.indexType())?ds(s):new Wt,o=new ce(e.get(i),s,i,a.isOrdered()),n=new Pn(t.name(),o,t.nullable(),us(t))):(s=(s=a.indexType())?ds(s):new Wt,e.set(i,r=hs(t,ls(t,e))),o=new ce(r,s,i,a.isOrdered()),n=new Pn(t.name(),o,t.nullable(),us(t))):(r=hs(t,ls(t,e)),n=new Pn(t.name(),r,t.nullable(),us(t)));return n||null},Pn.fromJSON=function(t,e){let i,n,r,s,o,a;return e&&(s=t.dictionary)?e.has(i=s.id)?(n=(n=s.indexType)?Xr(n):new Wt,a=new ce(e.get(i),n,i,s.isOrdered),r=new Pn(t.name,a,t.nullable,Qr(t.customMetadata))):(n=(n=s.indexType)?Xr(n):new Wt,e.set(i,o=ts(t,Gr(t,e))),a=new ce(o,n,i,s.isOrdered),r=new Pn(t.name,a,t.nullable,Qr(t.customMetadata))):(o=ts(t,Gr(t,e)),r=new Pn(t.name,o,t.nullable,Qr(t.customMetadata))),r||null},zn.encode=function(t,e){const i=e.fields.map((e=>Pn.encode(t,e)));Rn.startFieldsVector(t,i.length);const n=Rn.createFieldsVector(t,i),r=e.metadata&&e.metadata.size>0?Rn.createCustomMetadataVector(t,[...e.metadata].map((([e,i])=>{const n=t.createString(`${e}`),r=t.createString(`${i}`);return on.startKeyValue(t),on.addKey(t,n),on.addValue(t,r),on.endKeyValue(t)}))):-1;Rn.startSchema(t),Rn.addFields(t,n),Rn.addEndianness(t,ps?cn.Little:cn.Big),-1!==r&&Rn.addCustomMetadata(t,r);return Rn.endSchema(t)},zn.decode=function(t,e=new Map){const i=function(t,e){const i=[];for(let n,r=-1,s=-1,o=t.fieldsLength();++r<o;)(n=t.fields(r))&&(i[++s]=Pn.decode(n,e));return i}(t,e);return new zn(i,us(t),e)},zn.fromJSON=function(t,e=new Map){return new zn(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>Pn.fromJSON(t,e)))}(t,e),Qr(t.customMetadata),e)},ss.encode=function(t,e){const i=e.nodes||[],n=e.buffers||[];$r.startNodesVector(t,i.length);for(const o of i.slice().reverse())cs.encode(t,o);const r=t.endVector();$r.startBuffersVector(t,n.length);for(const o of n.slice().reverse())as.encode(t,o);const s=t.endVector();return $r.startRecordBatch(t),$r.addLength(t,new es(e.length,0)),$r.addNodes(t,r),$r.addBuffers(t,s),$r.endRecordBatch(t)},ss.decode=function(t,e=H.V4){return new ss(t.length(),function(t){const e=[];for(let i,n=-1,r=-1,s=t.nodesLength();++n<s;)(i=t.nodes(n))&&(e[++r]=cs.decode(i));return e}(t),function(t,e){const i=[];for(let n,r=-1,s=-1,o=t.buffersLength();++r<o;)(n=t.buffers(r))&&(e<H.V4&&(n.bb_pos+=8*(r+1)),i[++s]=as.decode(n));return i}(t,e))},ss.fromJSON=Jr,os.encode=function(t,e){const i=ss.encode(t,e.data);return Wr.startDictionaryBatch(t),Wr.addId(t,new es(e.id,0)),Wr.addIsDelta(t,e.isDelta),Wr.addData(t,i),Wr.endDictionaryBatch(t)},os.decode=function(t,e=H.V4){return new os(ss.decode(t.data(),e),t.id(),t.isDelta())},os.fromJSON=function(t){return new os(Jr(t.data),t.id,t.isDelta)},cs.encode=function(t,e){return kr.createFieldNode(t,new es(e.length,0),new es(e.nullCount,0))},cs.decode=function(t){return new cs(t.length(),t.nullCount())},as.encode=function(t,e){return jr.createBuffer(t,new es(e.offset,0),new es(e.length,0))},as.decode=function(t){return new as(t.offset(),t.length())};const ps=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),ys=t=>`Expected ${rt[t]} Message in stream, but was null or length 0.`,fs=t=>`Header pointer of flatbuffer-encoded ${rt[t]} Message is null or length 0.`,bs=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,ms=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class vs{constructor(t){this.source=t instanceof tr?t:new tr(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?Gn:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(ys(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=R(this.source.read(t));if(e.byteLength<t)throw new Error(ms(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=rt.Schema,i=this.readMessage(e),n=null==i?void 0:i.header();if(t&&!n)throw new Error(fs(e));return n}readMetadataLength(){const t=this.source.read(ws),e=t&&new i(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return Gn;if(e.byteLength<t)throw new Error(bs(t,e.byteLength));return{done:!1,value:rs.decode(e)}}}class gs{constructor(t,e){this.source=t instanceof er?t:D(t)?new sr(t,e):new er(t)}[Symbol.asyncIterator](){return this}next(){return r(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?Gn:t}))}throw(t){return r(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return r(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return r(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(ys(t));return e.value}))}readMessageBody(t){return r(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=R(yield this.source.read(t));if(e.byteLength<t)throw new Error(ms(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return r(this,void 0,void 0,(function*(){const e=rt.Schema,i=yield this.readMessage(e),n=null==i?void 0:i.header();if(t&&!n)throw new Error(fs(e));return n}))}readMetadataLength(){return r(this,void 0,void 0,(function*(){const t=yield this.source.read(ws),e=t&&new i(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return r(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return Gn;if(e.byteLength<t)throw new Error(bs(t,e.byteLength));return{done:!1,value:rs.decode(e)}}))}}class _s extends vs{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Zn?t:new Zn(t)}next(){const{_json:t}=this;if(!this._schema){this._schema=!0;return{done:!1,value:rs.fromJSON(t.schema,rt.Schema)}}if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];this._body=e.data.columns;return{done:!1,value:rs.fromJSON(e,rt.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];this._body=e.columns;return{done:!1,value:rs.fromJSON(e,rt.RecordBatch)}}return this._body=[],Gn}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,i)=>[...e,...i.VALIDITY&&[i.VALIDITY]||[],...i.TYPE&&[i.TYPE]||[],...i.OFFSET&&[i.OFFSET]||[],...i.DATA&&[i.DATA]||[],...t(i.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(ys(t));return e.value}readSchema(){const t=rt.Schema,e=this.readMessage(t),i=null==e?void 0:e.header();if(!e||!i)throw new Error(fs(t));return i}}const ws=4,Is=new Uint8Array("ARROW1".length);for(let ks=0;ks<"ARROW1".length;ks+=1)Is[ks]="ARROW1".codePointAt(ks);function Ss(t,e=0){for(let i=-1,n=Is.length;++i<n;)if(Is[i]!==t[e+i])return!1;return!0}const Bs=Is.length,As=Bs+ws,Ts=2*Bs+ws;class Ds extends qn{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return I(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return k.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return k.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Ds?t:A(t)?function(t){return new Os(new Rs(t))}(t):D(t)?function(t){return r(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),i=new sr(t,e);return e>=Ts&&Ss(yield i.readAt(0,Bs+7&-8))?new Fs(new Es(i)):new xs(new Us(i))}))}(t):I(t)?(()=>r(this,void 0,void 0,(function*(){return yield Ds.from(yield t)})))():O(t)||M(t)||F(t)||B(t)?function(t){return r(this,void 0,void 0,(function*(){const e=yield t.peek(Bs+7&-8);return e&&e.byteLength>=4?Ss(e)?new Ms(new Cs(yield t.read())):new xs(new Us(t)):new xs(new Us(function(){return a(this,arguments,(function*(){}))}()))}))}(new er(t)):function(t){const e=t.peek(Bs+7&-8);return e&&e.byteLength>=4?Ss(e)?new Ms(new Cs(t.read())):new Os(new Ls(t)):new Os(new Ls(function*(){}()))}(new tr(t))}static readAll(t){return t instanceof Ds?t.isSync()?zs(t):Ps(t):A(t)||ArrayBuffer.isView(t)||S(t)||T(t)?zs(t):Ps(t)}}class Os extends Ds{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return a(this,arguments,(function*(){yield o(yield*c(l(this[Symbol.iterator]())))}))}}class xs extends Ds{constructor(t){super(t),this._impl=t}readAll(){var t,e;return r(this,void 0,void 0,(function*(){const i=new Array;try{for(var n,r=l(this);!(n=yield r.next()).done;){const t=n.value;i.push(t)}}catch(s){t={error:s}}finally{try{n&&!n.done&&(e=r.return)&&(yield e.call(r))}finally{if(t)throw t.error}}return i}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class Ms extends Os{constructor(t){super(t),this._impl=t}}class Fs extends xs{constructor(t){super(t),this._impl=t}}class Ns{constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const i=this._loadVectors(t,e,this.schema.fields),n=Mi({type:new ee(this.schema.fields),length:t.length,children:i});return new Er(this.schema,n)}_loadDictionaryBatch(t,e){const{id:i,isDelta:n}=t,{dictionaries:r,schema:s}=this,o=r.get(i);if(n||!o){const r=s.dictionaries.get(i),a=this._loadVectors(t.data,e,[r]);return(o&&n?o.concat(new nn(a)):new nn(a)).memoize()}return o.memoize()}_loadVectors(t,e,i){return new hr(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}class Ls extends Ns{constructor(t,e){super(e),this._reader=A(t)?new _s(this._handle=t):new vs(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=Vs(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):Gn}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):Gn}next(){if(this.closed)return Gn;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),n=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),n=e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new zr(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class Us extends Ns{constructor(t,e){super(e),this._reader=new gs(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return r(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return r(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=Vs(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return r(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):Gn}))}return(t){return r(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):Gn}))}next(){return r(this,void 0,void 0,(function*(){if(this.closed)return Gn;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const i=t.header(),n=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(i,n)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const i=t.header(),n=yield e.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(i,n);this.dictionaries.set(i.id,r)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new zr(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return r(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class Cs extends Ls{constructor(t,e){super(t instanceof rr?t:new rr(t),e)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(i&&this._handle.seek(i.offset)){const t=this._reader.readMessage(rt.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),i=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,i)}}return null}_readDictionaryBatch(t){var e;const i=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(i&&this._handle.seek(i.offset)){const t=this._reader.readMessage(rt.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),i=this._reader.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(e,i);this.dictionaries.set(e.id,n)}}}_readFooter(){const{_handle:t}=this,e=t.size-As,i=t.readInt32(e),n=t.readAt(e-i,i);return Hn.decode(n)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(i&&this._handle.seek(i.offset))return this._reader.readMessage(t)}return null}}class Es extends Us{constructor(t,...e){const i="number"!=typeof e[0]?e.shift():void 0,n=e[0]instanceof Map?e.shift():void 0;super(t instanceof sr?t:new sr(t,i),n)}get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return r(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return r(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const i=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(i&&(yield this._handle.seek(i.offset))){const t=yield this._reader.readMessage(rt.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),i=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,i)}}return null}))}_readDictionaryBatch(t){var e;return r(this,void 0,void 0,(function*(){const i=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(i&&(yield this._handle.seek(i.offset))){const t=yield this._reader.readMessage(rt.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),i=yield this._reader.readMessageBody(t.bodyLength),n=this._loadDictionaryBatch(e,i);this.dictionaries.set(e.id,n)}}}))}_readFooter(){return r(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-As,i=yield t.readInt32(e),n=yield t.readAt(e-i,i);return Hn.decode(n)}))}_readNextMessageAndValidate(t){return r(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class Rs extends Ls{constructor(t,e){super(t,e)}_loadVectors(t,e,i){return new pr(e,t.nodes,t.buffers,this.dictionaries).visitMany(i)}}function Vs(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*zs(t){const e=Ds.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function Ps(t){return a(this,arguments,(function*(){const e=yield o(Ds.from(t));try{if(!(yield o(e.open({autoDestroy:!1}))).closed)do{yield yield o(e)}while(!(yield o(e.reset().open())).closed)}finally{yield o(e.cancel())}}))}function js(t){const e=Ds.from(t);return I(e)?(()=>r(this,void 0,void 0,(function*(){return new Cr(yield(yield e).readAll())})))():new Cr(e.readAll())}export{js as t};
